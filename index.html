<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Fluency for Ecommerce Directors | 30-Day Programme</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@400;700&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-card-hover: #1a1a25;
            --accent-primary: #00d4aa;
            --accent-secondary: #ff6b35;
            --accent-tertiary: #7c3aed;
            --text-primary: #e8e8e8;
            --text-secondary: #a0a0a0;
            --text-muted: #606060;
            --success: #00d4aa;
            --warning: #ffb800;
            --error: #ff4757;
            --border: #2a2a35;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Atkinson Hyperlegible', sans-serif; background: var(--bg-dark); color: var(--text-primary); line-height: 1.8; letter-spacing: 0.02em; }
        code, .code-block { font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; }
        .container { max-width: 900px; margin: 0 auto; padding: 80px 1.5rem 3rem; }
        .nav { position: fixed; top: 0; left: 0; right: 0; background: rgba(10,10,15,0.95); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); padding: 1rem 1.5rem; z-index: 1000; display: flex; justify-content: space-between; align-items: center; }
        .nav-brand { font-weight: 700; color: var(--accent-primary); }
        .progress-bar { height: 3px; background: var(--border); position: fixed; top: 60px; left: 0; right: 0; z-index: 999; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-tertiary)); width: 0%; transition: width 0.5s; }
        .hero { text-align: center; padding: 2rem 0; border-bottom: 1px solid var(--border); margin-bottom: 2rem; }
        .hero h1 { font-size: 2rem; background: linear-gradient(135deg, var(--text-primary), var(--accent-primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 1rem; }
        .hero p { color: var(--text-secondary); max-width: 600px; margin: 0 auto; }
        .week-section { margin-bottom: 2rem; }
        .week-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border); }
        .week-number { background: var(--bg-card); border: 2px solid var(--accent-tertiary); color: var(--accent-tertiary); width: 45px; height: 45px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 700; }
        .week-info h2 { font-size: 1.2rem; }
        .week-desc { color: var(--text-secondary); font-size: 0.9rem; }
        .day-grid { display: grid; gap: 0.75rem; }
        .day-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 1rem 1.25rem; cursor: pointer; transition: all 0.2s; position: relative; }
        .day-card:hover { background: var(--bg-card-hover); border-color: var(--accent-primary); transform: translateX(4px); }
        .day-card.locked { opacity: 0.5; cursor: not-allowed; }
        .day-card.locked:hover { transform: none; border-color: var(--border); }
        .day-card.completed { border-left: 4px solid var(--success); }
        .day-card.current { border-left: 4px solid var(--accent-secondary); }
        .day-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
        .day-number { font-weight: 700; color: var(--accent-primary); font-size: 0.85rem; }
        .day-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 0.25rem; }
        .day-desc { color: var(--text-secondary); font-size: 0.9rem; }
        .lesson-view { display: none; }
        .lesson-view.active { display: block; }
        .lesson-header { padding: 1.5rem 0; border-bottom: 1px solid var(--border); margin-bottom: 2rem; }
        .back-btn { background: none; border: none; color: var(--text-secondary); cursor: pointer; font-family: inherit; font-size: 0.95rem; padding: 0; margin-bottom: 1rem; display: block; }
        .back-btn:hover { color: var(--accent-primary); }
        .lesson-title { font-size: 1.75rem; margin-bottom: 0.5rem; }
        .lesson-meta { color: var(--text-secondary); font-size: 0.9rem; }
        .lesson-content { font-size: 1.05rem; }
        .lesson-content h2 { color: var(--accent-primary); font-size: 1.4rem; margin: 2rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border); }
        .lesson-content h3 { font-size: 1.2rem; margin: 1.5rem 0 0.75rem; color: var(--text-primary); }
        .lesson-content h4 { font-size: 1.05rem; margin: 1.25rem 0 0.5rem; color: var(--accent-secondary); }
        .lesson-content p { margin-bottom: 1rem; color: var(--text-secondary); }
        .lesson-content ul, .lesson-content ol { margin-bottom: 1rem; padding-left: 1.5rem; color: var(--text-secondary); }
        .lesson-content li { margin-bottom: 0.4rem; }
        .lesson-content strong { color: var(--text-primary); }
        .code-block { background: #1a1a24; border: 1px solid var(--border); border-radius: 10px; padding: 1rem; margin: 1rem 0; overflow-x: auto; position: relative; }
        .code-block::before { content: attr(data-lang); position: absolute; top: 0; right: 0; background: var(--accent-tertiary); color: white; padding: 0.2rem 0.6rem; font-size: 0.7rem; border-radius: 0 10px 0 6px; }
        .code-block code { white-space: pre; display: block; line-height: 1.5; }
        .info-box { border-left: 4px solid var(--accent-tertiary); padding: 1rem; margin: 1.5rem 0; background: rgba(124,58,237,0.1); border-radius: 0 10px 10px 0; }
        .info-box.warning { border-color: var(--warning); background: rgba(255,184,0,0.1); }
        .info-box.critical { border-color: var(--error); background: rgba(255,71,87,0.1); }
        .info-box.success { border-color: var(--success); background: rgba(0,212,170,0.1); }
        .info-box-title { font-weight: 700; margin-bottom: 0.5rem; }
        .exercise { background: var(--bg-card); border: 2px solid var(--warning); border-radius: 12px; padding: 1.25rem; margin: 1.5rem 0; }
        .exercise-header { color: var(--warning); font-weight: 700; margin-bottom: 0.75rem; }
        .quiz-section { background: var(--bg-card); border: 2px solid var(--accent-tertiary); border-radius: 12px; padding: 1.5rem; margin: 2rem 0; }
        .quiz-progress { font-size: 0.9rem; color: var(--text-muted); margin-bottom: 1rem; }
        .quiz-question { font-weight: 700; font-size: 1.1rem; margin-bottom: 1rem; padding: 1rem; background: var(--bg-dark); border-radius: 8px; }
        .quiz-options { display: grid; gap: 0.6rem; }
        .quiz-option { background: var(--bg-dark); border: 2px solid var(--border); border-radius: 8px; padding: 0.9rem 1rem; cursor: pointer; display: flex; align-items: flex-start; gap: 0.75rem; transition: all 0.2s; }
        .quiz-option:hover { border-color: var(--accent-tertiary); }
        .quiz-option.selected { border-color: var(--accent-primary); background: rgba(0,212,170,0.1); }
        .quiz-option.correct { border-color: var(--success); background: rgba(0,212,170,0.15); }
        .quiz-option.incorrect { border-color: var(--error); background: rgba(255,71,87,0.15); }
        .option-letter { min-width: 26px; height: 26px; border-radius: 5px; background: var(--border); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85rem; }
        .quiz-option.correct .option-letter { background: var(--success); color: var(--bg-dark); }
        .quiz-option.incorrect .option-letter { background: var(--error); color: white; }
        .quiz-feedback { margin-top: 1rem; padding: 1rem; border-radius: 8px; display: none; }
        .quiz-feedback.show { display: block; }
        .quiz-feedback.correct { background: rgba(0,212,170,0.15); border: 1px solid var(--success); }
        .quiz-feedback.incorrect { background: rgba(255,71,87,0.15); border: 1px solid var(--error); }
        .quiz-nav { display: flex; justify-content: space-between; margin-top: 1.25rem; padding-top: 1rem; border-top: 1px solid var(--border); }
        .btn { padding: 0.75rem 1.25rem; border-radius: 8px; font-weight: 700; cursor: pointer; border: none; font-family: inherit; transition: all 0.2s; }
        .btn-primary { background: var(--accent-primary); color: var(--bg-dark); }
        .btn-primary:hover { transform: translateY(-2px); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-secondary { background: transparent; color: var(--text-primary); border: 2px solid var(--border); }
        .btn-secondary:hover { border-color: var(--accent-primary); }
        .essay-section { background: var(--bg-card); border: 2px solid var(--accent-secondary); border-radius: 12px; padding: 1.5rem; margin: 2rem 0; }
        .essay-header { color: var(--accent-secondary); font-weight: 700; margin-bottom: 1rem; }
        .essay-question { margin-bottom: 1rem; }
        .essay-textarea { width: 100%; min-height: 200px; background: var(--bg-dark); border: 1px solid var(--border); border-radius: 8px; padding: 1rem; color: var(--text-primary); font-family: inherit; font-size: 1rem; resize: vertical; }
        .essay-textarea:focus { outline: 2px solid var(--accent-primary); border-color: transparent; }
        .quiz-results { text-align: center; padding: 2rem; }
        .score-display { font-size: 2.5rem; font-weight: 700; color: var(--accent-primary); }
        .btn-group { display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap; }
        .reset-btn { position: fixed; bottom: 1rem; right: 1rem; background: var(--bg-card); border: 1px solid var(--border); color: var(--text-muted); padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.8rem; cursor: pointer; }
        .toc { background: var(--bg-card); border: 1px solid var(--border); border-radius: 10px; padding: 1.25rem; margin: 1.5rem 0; }
        .toc-title { font-weight: 700; color: var(--accent-primary); margin-bottom: 0.75rem; }
        .toc-list { list-style: none; padding: 0; }
        .toc-list li { padding: 0.4rem 0; border-bottom: 1px solid var(--border); color: var(--text-secondary); font-size: 0.95rem; }
        .toc-list li:last-child { border: none; }
        @media (max-width: 600px) {
            .container { padding: 70px 1rem 2rem; }
            .btn-group { flex-direction: column; }
            .quiz-nav { flex-direction: column; gap: 0.75rem; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-brand">TECH FLUENCY: DIRECTOR LEVEL</div>
        <div style="color: var(--text-secondary); font-size: 0.9rem;"><span id="completedCount">0</span>/30 Complete</div>
    </nav>
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    
    <div class="container">
        <div id="dashboardView">
            <header class="hero">
                <h1>Technical Fluency for Ecommerce Directors</h1>
                <p>Deep technical knowledge, hands-on exercises, and real understanding. 1000+ words per lesson, 5 quiz questions + essay per day.</p>
            </header>
            <section class="week-section"><div class="week-header"><div class="week-number">W1</div><div class="week-info"><h2>Infrastructure & Architecture</h2><p class="week-desc">Deep dive into how web systems work at scale</p></div></div><div class="day-grid" id="week1Grid"></div></section>
            <section class="week-section"><div class="week-header"><div class="week-number">W2</div><div class="week-info"><h2>Frontend Engineering</h2><p class="week-desc">HTML, CSS, JavaScript and modern patterns</p></div></div><div class="day-grid" id="week2Grid"></div></section>
            <section class="week-section"><div class="week-header"><div class="week-number">W3</div><div class="week-info"><h2>Backend & Integrations</h2><p class="week-desc">Servers, databases, APIs and payment systems</p></div></div><div class="day-grid" id="week3Grid"></div></section>
            <section class="week-section"><div class="week-header"><div class="week-number">W4</div><div class="week-info"><h2>Operations & Security</h2><p class="week-desc">DevOps, monitoring, security, and performance</p></div></div><div class="day-grid" id="week4Grid"></div></section>
            <section class="week-section"><div class="week-header"><div class="week-number">+</div><div class="week-info"><h2>Leadership & Strategy</h2><p class="week-desc">Technical decision making and roadmapping</p></div></div><div class="day-grid" id="bonusGrid"></div></section>
        </div>
        <div id="lessonView" class="lesson-view"></div>
    </div>
    <button class="reset-btn" onclick="resetProgress()">Reset Progress</button>

<script>
// Course Data - Full content for Week 1, structure for remaining weeks
const courseData = {
    week1: [
        {
            day: 1,
            title: "The HTTP Protocol Deep Dive",
            desc: "Understanding the foundation of all web communication",
            duration: "45 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>By the end of this lesson, you will understand HTTP at a level that allows you to debug integration issues, evaluate API documentation, and have informed conversations about web performance and security.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. What HTTP Actually Is</li>
        <li>2. The Anatomy of HTTP Requests</li>
        <li>3. HTTP Methods and Idempotency</li>
        <li>4. Status Codes Deep Dive</li>
        <li>5. Headers That Control Behavior</li>
        <li>6. HTTPS and TLS</li>
        <li>7. Hands-On Exercise</li>
    </ul>
</div>

<h2>1. What HTTP Actually Is</h2>

<p>HTTP (Hypertext Transfer Protocol) is a stateless, text-based, application-layer protocol that defines how clients and servers communicate. Every interaction your customers have‚Äîviewing products, adding to cart, checking out‚Äîhappens through HTTP.</p>

<p><strong>Stateless</strong> means each request-response cycle is independent. The server has no inherent memory of previous requests. When a customer adds a product to their cart then navigates away, the server doesn't automatically know about their cart‚Äîunless we explicitly tell it via cookies, sessions, or tokens.</p>

<p>Understanding statelessness explains common bugs:</p>
<ul>
    <li>"Why do customers keep getting logged out?" ‚Üí Session cookies not being set correctly</li>
    <li>"Why does the cart empty on different devices?" ‚Üí Sessions are device-specific unless stored against user accounts</li>
</ul>

<h2>2. The Anatomy of HTTP Requests</h2>

<p>Every HTTP request has four parts: request line, headers, empty line, and optional body. Here's a real example‚Äîadding a product to cart:</p>

<div class="code-block" data-lang="HTTP Request">
<code>POST /api/cart/items HTTP/1.1
Host: www.yourstore.com
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIs...
Cookie: session_id=abc123
User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 17_0)
Content-Length: 89

{"product_id": "RING-001", "quantity": 1, "size": "M"}</code>
</div>

<p><strong>Request Line:</strong> POST /api/cart/items HTTP/1.1 tells the server the method (POST‚Äîcreating something), path, and protocol version.</p>

<p><strong>Key Headers:</strong></p>
<ul>
    <li><strong>Host:</strong> Which domain‚Äîessential because one server might host multiple sites</li>
    <li><strong>Content-Type:</strong> How the body is formatted (application/json)</li>
    <li><strong>Authorization:</strong> Credentials proving who the user is</li>
    <li><strong>Cookie:</strong> Session data the browser automatically includes</li>
</ul>

<h2>3. HTTP Methods and Idempotency</h2>

<div class="code-block" data-lang="HTTP Methods">
<code>GET     ‚Üí Retrieve. SAFE (no side effects) and IDEMPOTENT
POST    ‚Üí Create new resource. NOT idempotent
PUT     ‚Üí Replace entire resource. IDEMPOTENT
PATCH   ‚Üí Partial update. May or may not be idempotent
DELETE  ‚Üí Remove resource. IDEMPOTENT
HEAD    ‚Üí Like GET but headers only
OPTIONS ‚Üí What methods are allowed (CORS preflight)</code>
</div>

<p><strong>Idempotency is crucial for reliability.</strong> An idempotent operation produces the same result whether performed once or multiple times. Consider a payment timeout:</p>
<ul>
    <li>If the payment endpoint is idempotent (or uses idempotency keys), retrying is safe</li>
    <li>If not, retrying might charge the customer twice</li>
</ul>

<p>This is why Stripe uses Idempotency-Key headers. You generate a unique key per payment attempt. Retrying with the same key returns the original result.</p>

<h2>4. Status Codes Deep Dive</h2>

<h3>2xx: Success</h3>
<ul>
    <li><strong>200 OK:</strong> Standard success</li>
    <li><strong>201 Created:</strong> New resource created (should include Location header)</li>
    <li><strong>204 No Content:</strong> Success but nothing to return (common for DELETE)</li>
</ul>

<h3>3xx: Redirection</h3>
<ul>
    <li><strong>301:</strong> Permanent redirect‚Äîbrowsers cache this, SEO passes to new URL</li>
    <li><strong>302:</strong> Temporary redirect (ambiguous‚Äîprefer 307)</li>
    <li><strong>304:</strong> Not Modified‚Äîyour cached version is still valid</li>
    <li><strong>307:</strong> Temporary redirect that preserves method (POST stays POST)</li>
</ul>

<h3>4xx: Client Errors</h3>
<ul>
    <li><strong>400:</strong> Bad Request‚Äîmalformed syntax</li>
    <li><strong>401:</strong> Unauthorized‚Äîauthentication required (really means "unauthenticated")</li>
    <li><strong>403:</strong> Forbidden‚Äîauthenticated but not permitted</li>
    <li><strong>404:</strong> Not Found</li>
    <li><strong>422:</strong> Unprocessable‚Äîvalid syntax but semantic errors</li>
    <li><strong>429:</strong> Too Many Requests‚Äîrate limited</li>
</ul>

<h3>5xx: Server Errors</h3>

<div class="info-box critical">
    <div class="info-box-title">üî¥ Critical: 502 vs 503 vs 504</div>
    <p><strong>502 Bad Gateway:</strong> Your proxy received an invalid response from upstream. Your app likely crashed.</p>
    <p><strong>503 Service Unavailable:</strong> Server temporarily overloaded. Usually recoverable with retry.</p>
    <p><strong>504 Gateway Timeout:</strong> Upstream didn't respond in time. Dangerous‚Äîthe request might still be processing!</p>
</div>

<h2>5. Headers That Control Behavior</h2>

<h3>Caching Headers</h3>
<div class="code-block" data-lang="Cache Headers">
<code>Cache-Control: public, max-age=31536000, immutable
# Cache publicly for 1 year, never revalidate

Cache-Control: private, no-cache
# Only browser, always check if modified

Cache-Control: no-store
# Never cache (sensitive data)

ETag: "abc123"
# Version identifier for conditional requests</code>
</div>

<h3>Security Headers</h3>
<div class="code-block" data-lang="Security Headers">
<code>Strict-Transport-Security: max-age=31536000
# Force HTTPS for 1 year

Content-Security-Policy: default-src 'self'
# Control where resources load from

X-Frame-Options: DENY
# Prevent iframe embedding (clickjacking)</code>
</div>

<h2>6. HTTPS and TLS</h2>

<p>HTTPS is HTTP over TLS (Transport Layer Security). TLS provides:</p>
<ol>
    <li><strong>Confidentiality:</strong> Data is encrypted</li>
    <li><strong>Integrity:</strong> Data can't be modified in transit</li>
    <li><strong>Authentication:</strong> You're talking to the real server</li>
</ol>

<p><strong>Common certificate issues:</strong></p>
<ul>
    <li><strong>Expired:</strong> Certs expire annually. Set up monitoring and auto-renewal.</li>
    <li><strong>Name mismatch:</strong> Cert for example.com doesn't cover www.example.com</li>
    <li><strong>Untrusted CA:</strong> Self-signed or unknown Certificate Authority</li>
</ul>

<h2>7. Hands-On Exercise</h2>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: HTTP Inspection</div>
    <ol>
        <li>Open your site with DevTools Network tab</li>
        <li>Find the main document request‚Äîwhat caching headers are present?</li>
        <li>Add a product to cart‚Äîfind the XHR request. What method? What status?</li>
        <li>Look for any 3xx redirects‚Äîwhat's being redirected?</li>
        <li>Check security headers on the main response</li>
    </ol>
</div>
`,
            questions: [
                { q: "Checkout intermittently logs customers out. Based on HTTP's stateless nature, what should you investigate?", options: ["Login form JavaScript bug", "Session cookie or storage problems‚Äîcookies not being set, session store clearing, SameSite attributes", "Customer internet speed", "Server memory"], correct: 1, explanation: "HTTP is stateless‚Äîthe server only knows a user is logged in if something tells it on every request. Intermittent logouts almost always trace to session cookies not being sent correctly or session storage losing data." },
                { q: "Payment times out with 504. Customer says they were charged but got no confirmation. What likely happened?", options: ["Payment definitely failed", "Payment might still have processed‚Äî504 means we gave up waiting, not that it failed", "Payment succeeded and was recorded", "Server needs more capacity"], correct: 1, explanation: "504 means our server gave up waiting for a response. The payment could have succeeded‚Äîthe provider might have processed it, but the response didn't return in time. This is why idempotency keys are critical." },
                { q: "API uses GET /cart/add?product_id=123 to add items. What's wrong?", options: ["Nothing‚ÄîGET is faster", "GET should be safe and idempotent‚Äîbrowsers might prefetch it, bots might trigger it, back button might re-add items", "GET can't have query params", "URL too long"], correct: 1, explanation: "GET must be 'safe' (no side effects). Using GET for cart additions violates HTTP semantics and causes problems: prefetch adds items automatically, back button re-adds items, search crawlers might add items while indexing." },
                { q: "Developer returns 200 OK with {success: false, error: 'Not found'} for missing products. Why is this bad?", options: ["JSON is wrong", "HTTP status codes drive infrastructure‚Äîmonitoring, caching, retry logic all expect correct status codes. Return 404.", "Success should be true", "Error message too short"], correct: 1, explanation: "Status codes aren't just for humans‚Äîthey drive infrastructure behavior. 200 gets cached, doesn't trigger alerts, retry logic doesn't activate. Returning 200 for errors means CDNs cache errors, monitoring misses failures." },
                { q: "Product prices are cached for 24 hours. You update a price but customers see the old one. What's the proper fix?", options: ["Disable caching", "Use cache-busting URLs (versioned filenames) or implement proper Cache-Control with ETags", "Ask customers to clear cache", "Reduce cache to 1 minute"], correct: 1, explanation: "Cache invalidation is hard. Most reliable: URL versioning‚Äînew content gets new URL. For stable URLs, use ETags with short max-age. Disabling caching entirely hurts performance." }
            ],
            essay: {
                question: "You're meeting with your CTO about checkout completion rates dropping during flash sales. Using your HTTP knowledge, explain three different HTTP-related factors that could contribute, how to diagnose each using dev tools or logs, and technical solutions.",
                guidance: "Strong answers discuss: (1) 503/504 errors from overload‚ÄîNetwork tab shows 5xx, solved with scaling/caching/queuing; (2) Slow TTFB in timing breakdown‚Äîserver processing bottlenecks; (3) Connection limits and HTTP/1.1 blocking‚Äîwaterfall shows queued requests, solved by HTTP/2; (4) Third-party script failures blocking checkout."
            }
        },
        {
            day: 2,
            title: "DNS, Load Balancing & CDN Architecture",
            desc: "How traffic finds your servers and scales globally",
            duration: "50 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Understand the complete journey from domain name to server response‚ÄîDNS resolution, load balancing strategies, and CDN architecture. Essential for diagnosing outages, planning migrations, and understanding global performance.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. DNS Fundamentals</li>
        <li>2. DNS Record Types</li>
        <li>3. Load Balancing Strategies</li>
        <li>4. CDN Architecture</li>
        <li>5. Cache Invalidation</li>
    </ul>
</div>

<h2>1. DNS Fundamentals</h2>

<p>DNS translates domain names (yourstore.com) to IP addresses (104.21.55.123). It's a globally distributed, hierarchical database.</p>

<p><strong>The DNS hierarchy:</strong></p>
<ul>
    <li><strong>Root Zone (.):</strong> 13 root server clusters globally</li>
    <li><strong>TLDs:</strong> .com, .co.uk‚Äîmanaged by registries like Verisign, Nominet</li>
    <li><strong>Second-Level:</strong> yourstore.com‚Äîwhat you purchase</li>
    <li><strong>Subdomains:</strong> www, api‚Äîyou control these</li>
</ul>

<p><strong>TTL (Time To Live)</strong> is critical. If your A record has TTL 86400 (24 hours), changing IPs means waiting up to 24 hours for caches to expire.</p>

<div class="info-box warning">
    <div class="info-box-title">‚ö†Ô∏è Pre-Migration TTL Strategy</div>
    <p>48-72 hours before DNS changes: Lower TTL to 300 seconds. Wait the old TTL duration. Then make changes‚Äîcaches refresh within 5 minutes. After success, raise TTL back.</p>
</div>

<h2>2. DNS Record Types</h2>

<div class="code-block" data-lang="DNS Records">
<code>A Record    ‚Üí Domain to IPv4 address
AAAA Record ‚Üí Domain to IPv6 address
CNAME       ‚Üí Alias to another domain (can't use at apex)
MX Record   ‚Üí Mail servers (with priority)
TXT Record  ‚Üí SPF, DKIM, verification strings
NS Record   ‚Üí Authoritative nameservers
CAA Record  ‚Üí Which CAs can issue SSL certs</code>
</div>

<p><strong>Email authentication records</strong> (critical for deliverability):</p>
<ul>
    <li><strong>SPF:</strong> Which servers can send email for your domain</li>
    <li><strong>DKIM:</strong> Cryptographic signature verification</li>
    <li><strong>DMARC:</strong> Policy for handling failed authentication</li>
</ul>

<h2>3. Load Balancing</h2>

<p><strong>Layer 4:</strong> Routes on IP/port only. Fast but no application awareness.</p>
<p><strong>Layer 7:</strong> Routes on HTTP content‚Äîpaths, headers, cookies. Enables sophisticated routing.</p>

<div class="code-block" data-lang="L7 Routing">
<code>/api/*     ‚Üí API server pool
/static/*  ‚Üí Static servers or CDN origin
/admin/*   ‚Üí Admin servers with IP whitelist
/*         ‚Üí Web application servers</code>
</div>

<p><strong>Algorithms:</strong> Round Robin, Weighted Round Robin, Least Connections, Least Response Time, IP Hash.</p>

<h2>4. CDN Architecture</h2>

<p>CDNs cache content at edge locations worldwide, reducing latency and origin load.</p>

<div class="code-block" data-lang="CDN Flow">
<code>Sydney user requests /images/ring.jpg
1. DNS resolves to nearest CDN edge (Sydney)
2. Sydney edge: CACHE HIT? Return (~20ms)
3. CACHE MISS? Forward to origin, cache response
4. Subsequent Sydney requests served from edge

Benefits:
- Latency: Edge 20ms vs origin 300ms
- Origin offload: 95%+ requests from cache
- DDoS protection: Traffic absorbed at edge</code>
</div>

<h2>5. Cache Control</h2>

<div class="code-block" data-lang="Cache-Control">
<code>public, max-age=31536000, immutable
# Static assets‚Äîcache forever

public, s-maxage=60, stale-while-revalidate=300
# HTML‚ÄîCDN caches 60s, serves stale while refreshing

private, no-store
# Personal content‚Äînever cache at CDN</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: DNS Investigation</div>
    <ol>
        <li>Run: nslookup yoursite.com</li>
        <li>Check TTL values‚Äîsuitable for quick changes?</li>
        <li>Look for CDN headers (CF-Ray, X-Cache) in DevTools</li>
        <li>Check cache HIT/MISS status on static assets</li>
    </ol>
</div>
`,
            questions: [
                { q: "Migrating from Magento to Shopify. DNS TTL is 86400. Correct approach?", options: ["Change DNS immediately", "Lower TTL to 300, wait 24 hours, then change DNS", "Ask customers to clear DNS cache", "CNAME ignores TTL"], correct: 1, explanation: "Lower TTL first, wait for old TTL to expire, then change. Otherwise resolvers keep old records cached for up to 24 hours." },
                { q: "Marketing emails going to spam. You have SPF and DKIM but no DMARC. What does DMARC do?", options: ["DMARC tells servers what to do when SPF/DKIM fail", "DMARC is just reporting", "Need MX record instead", "DMARC is optional"], correct: 0, explanation: "DMARC tells receivers your policy for handling authentication failures. Without it, Gmail makes its own decision and may be suspicious." },
                { q: "Site uses sticky sessions. Team wants Redis for sessions instead. Business benefit?", options: ["None", "Better resilience, smoother deployments, more even load distribution", "Redis is faster", "PCI requirement"], correct: 1, explanation: "Externalizing sessions enables true horizontal scaling: any server handles any request, servers can be replaced without losing sessions." },
                { q: "CDN shows 40% cache hit rate for images despite max-age=31536000. Likely cause?", options: ["40% is good", "Images may have unique query strings or Vary header is too broad", "CDN misconfigured", "Images too large"], correct: 1, explanation: "Low hit rates often mean cache fragmentation: unique query strings, broad Vary headers, or inconsistent URLs create separate cache entries." },
                { q: "Flash sale: origin overloaded despite 95% CDN hit rate on static assets. What's missing?", options: ["CDN not fast enough", "Dynamic HTML pages aren't cached‚Äîadd short s-maxage with stale-while-revalidate", "Image compression", "Database bottleneck"], correct: 1, explanation: "CDNs excel at static assets but dynamic pages often bypass caching. Even 5-second cache with stale-while-revalidate can reduce origin load 95%+." }
            ],
            essay: {
                question: "Your site went down for 2 hours during Black Friday last year (¬£200k lost). As new Head of Ecommerce, outline a technical plan covering: investigation approach, DNS configuration for failover, load balancing improvements, CDN optimization, and testing methodology.",
                guidance: "Cover: post-mortem analysis, lower TTL before sales, multi-region DNS with health checks, proper health checks and auto-scaling, maximize CDN caching including HTML, load testing and chaos engineering."
            }
        },
        {
            day: 3,
            title: "Web Servers, Containers & Cloud Infrastructure",
            desc: "Understanding compute infrastructure and deployment",
            duration: "50 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Understand the compute infrastructure running your ecommerce platform: web servers, application servers, containers, orchestration, and cloud patterns.</p>

<h2>1. Web Servers vs Application Servers</h2>

<p><strong>Web Server (Nginx, Apache):</strong> Handles HTTP‚Äîaccepts connections, serves static files, terminates SSL, forwards to application servers.</p>

<p><strong>Application Server (Gunicorn, PHP-FPM, Puma):</strong> Executes business logic‚Äîprocesses requests, queries databases, runs your code.</p>

<div class="code-block" data-lang="Request Flow">
<code>Customer ‚Üí Internet ‚Üí Nginx ‚Üí Gunicorn ‚Üí PostgreSQL
                       ‚Üì
                 Static files
                 (served directly)</code>
</div>

<h2>2. Containerization with Docker</h2>

<p>Docker packages applications with dependencies into portable containers. Unlike VMs, containers share the host kernel‚Äîlightweight and fast.</p>

<div class="code-block" data-lang="Dockerfile">
<code>FROM node:20-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npm run build
EXPOSE 3000
CMD ["node", "dist/server.js"]</code>
</div>

<p><strong>Layer caching:</strong> Copy package.json before code‚Äîdependencies only reinstall when package.json changes.</p>

<h2>3. Container Orchestration</h2>

<p>Kubernetes manages containers across servers: scheduling, scaling, networking, deployments.</p>

<p><strong>Key concepts:</strong></p>
<ul>
    <li><strong>Pod:</strong> Smallest unit‚Äîone or more containers</li>
    <li><strong>Deployment:</strong> Manages Pod replicas, rolling updates</li>
    <li><strong>Service:</strong> Stable network endpoint for Pods</li>
    <li><strong>Ingress:</strong> HTTP routing, SSL termination</li>
</ul>

<p><strong>Readiness vs Liveness probes:</strong></p>
<ul>
    <li><strong>Readiness:</strong> Can this Pod handle requests? Failed = removed from Service</li>
    <li><strong>Liveness:</strong> Is this Pod fundamentally healthy? Failed = restart container</li>
</ul>

<h2>4. Cloud Architecture</h2>

<div class="code-block" data-lang="AWS Stack">
<code>Route 53 (DNS)
    ‚Üì
CloudFront (CDN) ‚Üê S3 (Static assets)
    ‚Üì
WAF (Firewall)
    ‚Üì
ALB (Load Balancer)
    ‚Üì
ECS/EKS (Containers)
    ‚Üì
RDS + ElastiCache + OpenSearch</code>
</div>

<h2>5. Infrastructure as Code</h2>

<p>Define infrastructure in version-controlled files (Terraform, CloudFormation):</p>
<ul>
    <li>Version control every change</li>
    <li>Review process via pull requests</li>
    <li>Reproducible environments</li>
    <li>Disaster recovery from code</li>
</ul>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>Identify your stack: web server, app server, container orchestration?</li>
        <li>Is infrastructure defined as code or manually configured?</li>
        <li>How long to rebuild everything from scratch?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Nginx logs show thousands of static file requests but app logs show only 50/second. What's happening?", options: ["Logging bug", "Nginx serves static files directly without forwarding to app‚Äîcorrect, efficient configuration", "Nginx caching responses", "App dropping requests"], correct: 1, explanation: "This is optimal. Nginx serves static files directly, freeing the app server for business logic." },
                { q: "Developer says 'Docker is enough, we don't need Kubernetes.' When is this true?", options: ["Never", "For single-server deployments. K8s handles multi-server orchestration, scaling, health-based restarts, rolling updates", "Kubernetes is always overkill", "Docker can do everything"], correct: 1, explanation: "Docker runs containers on one machine. Kubernetes orchestrates across many machines with automatic scaling, healing, and deployments." },
                { q: "K8s deployment stuck: new Pods created but old ones not terminating. New Pods' /health returns 500. What's happening?", options: ["K8s broken", "Readiness probe protecting you‚Äînew Pods aren't healthy so old ones stay. Run migrations before deploying.", "Remove readiness probe", "Memory limit"], correct: 1, explanation: "K8s won't terminate old Pods until new ones pass readiness. Your deployment is stuck because new Pods aren't healthy." },
                { q: "Choosing between AWS ECS and EKS. Team has limited DevOps experience but expects growth. Factors?", options: ["Always EKS", "Always ECS", "ECS simpler/AWS-native, EKS provides K8s portability and ecosystem but needs more expertise. Match to team skills.", "Flip a coin"], correct: 2, explanation: "ECS is simpler and fully AWS-managed. EKS gives Kubernetes portability but requires more expertise. Consider team skills and multi-cloud needs." },
                { q: "Infrastructure was manually set up via AWS Console by a contractor who left. CTO asks about disaster recovery. Your answer?", options: ["Recover in an hour by clicking", "Without Infrastructure as Code, we can't reliably recreate the environment. Recovery could take days. We need to reverse-engineer into Terraform.", "AWS backs everything up", "Hope region doesn't fail"], correct: 1, explanation: "Manual 'ClickOps' is a major risk. Without IaC, you're relying on memory and hope. Reverse-engineering into Terraform is critical." }
            ],
            essay: {
                question: "Current infrastructure: single VPS with Magento, MySQL, Redis, Elasticsearch all on one machine. Revenue ¬£3M heading to ¬£10M. Propose a cloud architecture migration plan covering: current risks, target architecture, migration approach, new capabilities, and cost implications.",
                guidance: "Cover: single point of failure, no scaling; target with separate RDS, ElastiCache, managed ES, containerized app behind ALB with CDN; migration with parallel setup, database replication, low-TTL DNS cutover; new capabilities of scaling and automated backups; costs of ¬£2-5K/month vs ¬£200 now but includes operational value."
            }
        },
        {
            day: 4,
            title: "SQL Databases Deep Dive",
            desc: "Relational databases, queries, indexing, and performance",
            duration: "55 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Databases are the heart of ecommerce‚Äîevery product, customer, and order lives there. Today covers relational database concepts for conversations about migrations, performance, and architecture.</p>

<h2>1. Tables, Keys, and Relationships</h2>

<div class="code-block" data-lang="SQL">
<code>CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    sku VARCHAR(50) UNIQUE NOT NULL,
    name VARCHAR(255) NOT NULL,
    price_pence INTEGER NOT NULL,
    category_id INTEGER REFERENCES categories(id)
);</code>
</div>

<p><strong>Primary Key:</strong> Unique identifier. <strong>Foreign Key:</strong> References another table, establishing relationships.</p>

<h2>2. SQL Query Fundamentals</h2>

<div class="code-block" data-lang="SQL">
<code>-- Basic queries
SELECT name, price_pence FROM products WHERE is_active = true;

-- JOINs
SELECT p.name, c.name as category
FROM products p
JOIN categories c ON p.category_id = c.id;

-- Aggregations
SELECT category_id, COUNT(*), AVG(price_pence)
FROM products
GROUP BY category_id;</code>
</div>

<h2>3. Indexing</h2>

<p>Indexes speed up reads but slow writes. Create indexes on columns used in WHERE, JOIN, and ORDER BY.</p>

<div class="code-block" data-lang="SQL">
<code>CREATE INDEX idx_products_category ON products(category_id);
CREATE INDEX idx_orders_customer ON orders(customer_id);

-- Composite index for common query patterns
CREATE INDEX idx_products_active_category ON products(is_active, category_id);</code>
</div>

<h2>4. Transactions and ACID</h2>

<div class="code-block" data-lang="SQL">
<code>BEGIN;
INSERT INTO orders (customer_id, total) VALUES (123, 4999);
UPDATE products SET stock = stock - 1 WHERE id = 456;
COMMIT;  -- Both succeed or both fail</code>
</div>

<p><strong>ACID:</strong> Atomicity (all or nothing), Consistency (valid state), Isolation (concurrent safety), Durability (committed = permanent).</p>

<h2>5. Common Performance Issues</h2>

<p><strong>N+1 queries:</strong> Loading products then separately loading each product's images = 100 queries instead of 2.</p>

<p><strong>Missing indexes on foreign keys:</strong> Foreign keys don't automatically get indexes!</p>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>Check slow query logs‚Äîwhat queries take longest?</li>
        <li>Are foreign keys indexed?</li>
        <li>Run EXPLAIN on your slowest query</li>
    </ol>
</div>
`,
            questions: [
                { q: "Product listing takes 3 seconds, running 200 queries. Most likely problem?", options: ["Database too slow", "N+1 problem‚Äîloading products then separately loading related data for each. Fix with JOINs or eager loading.", "Need more indexes", "Too many products"], correct: 1, explanation: "200 queries for one page is classic N+1. One query gets products, 199 get related data individually. Fix with JOINs or ORM eager loading." },
                { q: "Query filters WHERE status='active' AND created_at > '2024-01-01'. You have separate indexes on both columns. How to improve?", options: ["Remove status index", "Create composite index on (status, created_at)‚Äîcovers both conditions in one lookup", "Run ANALYZE", "Already optimal"], correct: 1, explanation: "Composite index on (status, created_at) lets database satisfy both conditions in one index lookup. Order matters: equality condition first." },
                { q: "'Customers who bought this also bought' is slow on 10M order items. Best approach?", options: ["More indexes", "Pre-compute relationships into a lookup table updated periodically‚Äîdon't calculate live on every request", "Query read replica", "Limit to 30 days"], correct: 1, explanation: "Complex analytical queries shouldn't run on every page view. Pre-compute (materialize) results nightly into a simple lookup table." },
                { q: "Checkout creates order, adds items, decrements inventory. Sometimes orders have no items or inventory goes negative. Solution?", options: ["Database triggers", "Wrap operations in a transaction‚Äîall succeed or all fail together", "Stored procedures", "More backups"], correct: 1, explanation: "Transactions provide atomicity. Wrap all checkout operations in BEGIN/COMMIT. Add CHECK constraints to prevent negative inventory." },
                { q: "Reporting queries slow down production during business hours. DBA suggests 'use read replica.' What does this mean?", options: ["Backup database", "Read replicas are real-time copies handling read queries, offloading the primary. Complex reports run without affecting production writes.", "Cache instead", "Different SQL syntax"], correct: 1, explanation: "Read replicas sync from primary and handle their own reads. Heavy SELECT queries don't compete with production INSERTs/UPDATEs." }
            ],
            essay: {
                question: "Database has grown to 50GB with 5M orders and 20M line items. Load times increased from 200ms to 2 seconds over the past year. Write a diagnostic and improvement plan covering: identifying causes, quick wins, architectural improvements, and preventing future degradation.",
                guidance: "Cover: diagnostics with slow query logs, EXPLAIN, index usage; quick wins adding indexes, fixing N+1s, query caching; architecture with read replicas, connection pooling, archiving old data; monitoring with slow query alerts, query count tracking, regular EXPLAIN review."
            }
        },
        {
            day: 5,
            title: "NoSQL, Caching & Search Systems",
            desc: "Redis, MongoDB, Elasticsearch and when to use each",
            duration: "50 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Not every problem is best solved by SQL. Today covers when to use document stores, key-value caches, and search engines‚Äîand critically, when NOT to.</p>

<h2>1. Redis: In-Memory Data Store</h2>

<p>Redis stores data in memory for sub-millisecond operations. Use cases:</p>

<div class="code-block" data-lang="Redis">
<code># Sessions
SET session:abc123 '{"user_id": 456}' EX 86400

# Caching
SET cache:product:456 '{"name": "Ring"...}' EX 3600

# Rate limiting
INCR rate:user:456:minute
EXPIRE rate:user:456:minute 60

# Queues
LPUSH queue:emails '{"type": "order_confirmation"}'</code>
</div>

<div class="info-box warning">
    <div class="info-box-title">‚ö†Ô∏è Redis Data Loss</div>
    <p>Redis is in-memory. Data can be lost on restart. Never store data you can't regenerate. Configure persistence (RDB/AOF) for important data.</p>
</div>

<h2>2. Document Databases (MongoDB)</h2>

<p>When documents make sense: varying attributes across products (rings have sizes, necklaces have lengths).</p>

<div class="code-block" data-lang="MongoDB">
<code>{
    "_id": "prod_456",
    "name": "Luna Ring",
    "attributes": {
        "material": "Silver",
        "sizes": ["K", "L", "M"]
    }
}</code>
</div>

<p><strong>Don't use MongoDB for:</strong> Multi-document transactions, heavy relational data, complex reporting.</p>

<h2>3. Elasticsearch: Full-Text Search</h2>

<p>Why not SQL LIKE? It's slow (can't use indexes), has no relevance ranking, no fuzzy matching, no synonyms.</p>

<div class="code-block" data-lang="Elasticsearch">
<code>GET /products/_search
{
    "query": {
        "multi_match": {
            "query": "silver ring size M",
            "fields": ["name^3", "description"],
            "fuzziness": "AUTO"
        }
    }
}</code>
</div>

<p><strong>Key insight:</strong> Elasticsearch is a search INDEX, not a database. Keep your SQL database as source of truth, sync to Elasticsearch.</p>

<h2>4. Caching Strategies</h2>

<div class="code-block" data-lang="Cache-Aside">
<code>function getProduct(id) {
    cached = redis.get("product:" + id)
    if (cached) return cached
    
    product = database.query(id)
    redis.set("product:" + id, product, "EX", 3600)
    return product
}

function updateProduct(id, data) {
    database.update(id, data)
    redis.del("product:" + id)  // Invalidate
}</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>What caches does your platform use?</li>
        <li>How does site search work? SQL or dedicated engine?</li>
        <li>If you have Redis access, check cache hit rate: INFO stats</li>
    </ol>
</div>
`,
            questions: [
                { q: "Sessions stored in app server memory. Users get logged out on deployments and when hitting different servers. Solution?", options: ["Sticky sessions", "Move sessions to Redis‚Äîany server can access any session, enabling stateless servers", "Cookie sessions", "Longer timeout"], correct: 1, explanation: "Externalizing sessions to Redis makes servers truly stateless. Any server handles any request, enabling scaling and zero-downtime deployments." },
                { q: "Developer suggests MongoDB because products have 'different fields.' What else should you consider?", options: ["Approve immediately", "Do you need transactions? Complex reporting? What's the team's MongoDB expertise? PostgreSQL JSONB might work too.", "Reject MongoDB", "Only for 1M+ products"], correct: 1, explanation: "Schema flexibility isn't the only factor. Consider transactions, reporting needs, team expertise. PostgreSQL JSONB offers document flexibility within SQL." },
                { q: "CTO asks why you can't just add a SQL index for better search. How do you explain?", options: ["SQL indexes work fine", "SQL LIKE can't use indexes effectively, doesn't rank by relevance, can't handle typos or synonyms. Elasticsearch is purpose-built for text search.", "Elasticsearch is faster", "SQL can do everything ES can"], correct: 1, explanation: "SQL and Elasticsearch solve different problems. SQL LIKE requires table scans, returns unranked results, can't handle fuzzy matching or synonyms." },
                { q: "Cache hit rate only 20%. What causes this?", options: ["Redis too slow", "TTLs too short, cache keys too specific (including timestamps/user IDs), or high-cardinality data (unique queries)", "Need more memory", "20% is good"], correct: 1, explanation: "Low hit rates indicate: short TTLs, keys too specific (each request unique), high cardinality queries, or over-invalidation. Aim for 80%+." },
                { q: "Product price updated in database but Elasticsearch shows old price. What's happening?", options: ["ES is buggy", "ES is a separate index that must be synced. Sync is delayed (eventual consistency). Either sync immediately or accept brief inconsistency.", "Clear ES cache", "Customer needs refresh"], correct: 1, explanation: "Elasticsearch isn't your database‚Äîit's a search index that must be kept in sync. Accept eventual consistency or implement synchronous updates." }
            ],
            essay: {
                question: "Current platform uses only PostgreSQL for everything: products, orders, sessions, search (LIKE queries). Traffic growing, database at 80% CPU, search is slow, session bugs during deployments. Design a data architecture with appropriate specialized systems for each concern.",
                guidance: "Cover: sessions to Redis (enables scaling), caching with Redis (reduces DB load), search with Elasticsearch (relevance ranking, fuzzy matching), PostgreSQL remains source of truth for orders/customers. Address sync strategies and operational considerations."
            }
        },
        {
            day: 6,
            title: "API Design & REST Principles",
            desc: "Designing, consuming, and evaluating web APIs",
            duration: "50 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>APIs connect every system in ecommerce: payments, shipping, marketplaces, email. Today covers how to evaluate APIs, design internal ones, and debug integrations.</p>

<h2>1. REST Fundamentals</h2>

<p>REST uses <strong>resources</strong> (nouns) with HTTP methods:</p>

<div class="code-block" data-lang="REST">
<code>GET /products           # List
GET /products/456       # Read
POST /products          # Create
PUT /products/456       # Replace
PATCH /products/456     # Partial update
DELETE /products/456    # Delete

GET /orders/789/items   # Nested resources</code>
</div>

<h2>2. Authentication</h2>

<div class="code-block" data-lang="Auth">
<code># API Keys
Authorization: Bearer sk_live_abc123

# OAuth flow for user authorization
1. Redirect to provider
2. User grants permission
3. Receive authorization code
4. Exchange for access token
5. Use token for API calls</code>
</div>

<h2>3. Webhooks</h2>

<div class="code-block" data-lang="Webhooks">
<code># Stripe POSTs to your endpoint
POST /webhooks/stripe
{ "type": "payment_intent.succeeded", "data": {...} }

# Always:
1. Verify signature (HMAC)
2. Return 200 quickly
3. Process asynchronously
4. Handle retries idempotently</code>
</div>

<h2>4. Rate Limiting</h2>

<div class="code-block" data-lang="Rate Limits">
<code>X-RateLimit-Remaining: 98
Retry-After: 60

# On 429: wait Retry-After seconds
# Use exponential backoff
# Queue requests, don't drop</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>List all third-party APIs your platform uses</li>
        <li>Find rate limits for each‚Äîare you at risk?</li>
        <li>How do you verify webhook signatures?</li>
    </ol>
</div>
`,
            questions: [
                { q: "GET /searchProducts?name=ring‚Äîwhat's the REST issue?", options: ["GET can't have params", "Nothing", "Verb 'search' shouldn't be in URL. Use GET /products?name=ring", "Should use POST"], correct: 2, explanation: "REST URLs represent resources (nouns). Use GET /products with query params for filtering." },
                { q: "API returns 200 OK with {success: false, error: 'Not found'}. Problem?", options: ["JSON wrong", "200 should mean success. Use 404 so caching, monitoring, clients work correctly.", "Success should be true", "Message too short"], correct: 1, explanation: "Status codes drive infrastructure behavior. 200 gets cached, doesn't trigger alerts. Return appropriate 4xx/5xx for errors." },
                { q: "Getting 429 responses with Retry-After: 60. What should code do?", options: ["Retry immediately", "Switch providers", "Wait 60+ seconds, use exponential backoff, queue requests", "Increase quota"], correct: 2, explanation: "429 = rate limited. Respect Retry-After, use exponential backoff, queue rather than hammer the API." },
                { q: "Processing Stripe webhook without verifying signature. Risk?", options: ["None", "Attackers can send fake webhooks to mark orders as paid", "No signatures on webhooks", "Duplicate processing"], correct: 1, explanation: "Webhook endpoints are public. Without signature verification, attackers craft fake payloads. Always verify HMAC signatures." },
                { q: "Mobile app makes 3 API calls per product page. Better approach?", options: ["Parallel calls", "Support ?include=images,reviews to return all in one request", "Cache responses", "Already optimal"], correct: 1, explanation: "Multiple requests add latency, especially mobile. APIs should support including related resources in single request." }
            ],
            essay: {
                question: "Design a REST API for Click & Collect: list stores with stock, create/check/cancel reservations, mark as collected. Include URLs, methods, status codes, error scenarios, and webhooks for store systems.",
                guidance: "Cover: resource URLs (/stores, /reservations), proper methods, 201 Created with Location, error codes (409 out of stock, 404 store not found), webhooks (reservation.created, .collected, .expired)."
            }
        },
        {
            day: 7,
            title: "Week 1 Review & Architecture Exercise",
            desc: "Synthesize infrastructure knowledge",
            duration: "60 min",
            content: `
<h2>Week 1 Synthesis</h2>

<p>This week covered the complete technical stack from HTTP to databases. Let's bring it together.</p>

<h2>The Complete Request Journey</h2>

<div class="code-block" data-lang="Flow">
<code>1. Customer types URL
2. Browser checks DNS cache, then resolver
3. DNS returns IP (or CDN edge IP)
4. Browser connects via HTTPS/TLS
5. CDN: Cache HIT ‚Üí return immediately
6. CDN: MISS ‚Üí forward to origin
7. Load balancer routes to healthy server
8. Web server (Nginx) handles request
9. Static file ‚Üí serve directly
10. Dynamic ‚Üí forward to app server
11. App server processes, queries database
12. Response flows back: app ‚Üí web ‚Üí CDN ‚Üí browser</code>
</div>

<h2>Key Vocabulary</h2>

<ul>
    <li><strong>TTL:</strong> Time To Live‚Äîhow long before cache expires</li>
    <li><strong>Idempotent:</strong> Same result whether done once or many times</li>
    <li><strong>Stateless:</strong> No memory between requests</li>
    <li><strong>ACID:</strong> Atomicity, Consistency, Isolation, Durability</li>
    <li><strong>CDN:</strong> Content Delivery Network‚Äîedge caching</li>
    <li><strong>Load balancer:</strong> Distributes traffic across servers</li>
    <li><strong>Read replica:</strong> Database copy for read queries</li>
</ul>

<h2>Architecture Exercise</h2>

<div class="exercise">
    <div class="exercise-header">üîß Week 1 Capstone</div>
    <p>Draw your platform's architecture diagram showing:</p>
    <ol>
        <li>DNS provider and configuration</li>
        <li>CDN and caching strategy</li>
        <li>Load balancing setup</li>
        <li>Web and application servers</li>
        <li>Databases and caches</li>
        <li>External integrations (payments, shipping)</li>
    </ol>
    <p>Identify: single points of failure, scaling limitations, disaster recovery gaps.</p>
</div>
`,
            questions: [
                { q: "Customer complains site is slow in Australia. Your servers are in London. What's the primary cause and solution?", options: ["Slow servers", "Geographic latency‚Äîlight takes 150ms each way. Solution: CDN with Australian edge or regional deployment.", "Customer's internet", "Database"], correct: 1, explanation: "Physics: London to Sydney is ~300ms round trip minimum. CDN edges in Australia serve cached content locally. For dynamic content, consider regional deployment." },
                { q: "During sale, database CPU hits 100% and site crashes. Quick investigation reveals lots of identical queries. First action?", options: ["Upgrade database", "Add caching layer (Redis) for repeated queries", "Add read replica", "Optimize queries"], correct: 1, explanation: "Identical queries indicate missing cache. Redis caching of common queries provides immediate relief. Then investigate query optimization and read replicas for longer-term." },
                { q: "New payment integration times out randomly. Vendor says their API is fine. What should you investigate first?", options: ["Blame vendor", "Check your timeout settings, network path, and whether their API is in a different region adding latency", "Switch providers", "Add retry"], correct: 1, explanation: "Timeouts have many causes: your timeout too short, network issues, geographic latency, or intermittent vendor issues. Investigate systematically before blaming vendor." },
                { q: "Developer proposes moving from monolith to microservices for a team of 3. Your response?", options: ["Approve‚Äîmicroservices are modern", "For 3 people, microservices likely adds complexity without benefit. Monolith can scale far. Discuss specific pain points first.", "Reject", "Need more servers"], correct: 1, explanation: "Microservices add operational complexity (deployment, debugging, networking). For small teams, a well-structured monolith is often better. Address specific scaling pain points." },
                { q: "Site went down. Post-mortem reveals a config change that wasn't reviewed. How to prevent?", options: ["Better training", "Infrastructure as Code with pull request reviews‚Äîall changes reviewed before applying", "Manual checklist", "More documentation"], correct: 1, explanation: "IaC with PR reviews ensures all changes are reviewed by others before applying. Manual processes fail. Code review catches mistakes." }
            ],
            essay: {
                question: "Write a technical brief for your CEO explaining why you need to invest in infrastructure improvements. Cover current risks, proposed changes, business benefits (uptime, performance, development speed), and rough cost estimates. Assume non-technical audience.",
                guidance: "Translate technical concepts to business impact: single point of failure = risk of extended downtime and lost revenue; poor performance = reduced conversion rates; manual infrastructure = slow feature delivery and incident recovery. Quantify where possible."
            }
        }
    ],
    week2: [
        { 
            day: 8, 
            title: "HTML5 Semantics & Accessibility", 
            desc: "Semantic markup, ARIA, and inclusive design", 
            duration: "45 min", 
            content: `
<h2>Today's Learning Objectives</h2>
<p>HTML isn't just about making things appear on screen‚Äîit's about communicating meaning. Today you'll understand semantic HTML, accessibility requirements, and why this matters for SEO, legal compliance, and reaching all customers including the 20% with disabilities.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Why Semantics Matter</li>
        <li>2. Semantic HTML Elements</li>
        <li>3. Heading Hierarchy</li>
        <li>4. Accessibility Fundamentals</li>
        <li>5. ARIA: When HTML Isn't Enough</li>
        <li>6. Testing Accessibility</li>
    </ul>
</div>

<h2>1. Why Semantics Matter</h2>

<p>Consider two ways to mark up a navigation menu:</p>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Non-semantic: Works visually but meaningless to machines --&gt;
&lt;div class="nav"&gt;
    &lt;div class="nav-item"&gt;&lt;a href="/"&gt;Home&lt;/a&gt;&lt;/div&gt;
    &lt;div class="nav-item"&gt;&lt;a href="/products"&gt;Products&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;!-- Semantic: Communicates purpose --&gt;
&lt;nav aria-label="Main navigation"&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;a href="/"&gt;Home&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href="/products"&gt;Products&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/nav&gt;</code>
</div>

<p>The semantic version tells browsers, screen readers, and search engines: "This is navigation." Benefits:</p>
<ul>
    <li><strong>Accessibility:</strong> Screen readers announce "Navigation" and let users skip to it</li>
    <li><strong>SEO:</strong> Search engines understand page structure better</li>
    <li><strong>Maintainability:</strong> Code intent is clearer to developers</li>
</ul>

<h2>2. Semantic HTML Elements</h2>

<div class="code-block" data-lang="HTML Elements">
<code>&lt;header&gt;     Page or section header
&lt;nav&gt;        Navigation links
&lt;main&gt;       Primary content (one per page)
&lt;article&gt;    Self-contained content (blog post, product card)
&lt;section&gt;    Thematic grouping with heading
&lt;aside&gt;      Tangentially related (sidebar, related products)
&lt;footer&gt;     Page or section footer

&lt;figure&gt;     Self-contained media with caption
&lt;figcaption&gt; Caption for figure
&lt;time&gt;       Date/time (machine-readable)
&lt;address&gt;    Contact information
&lt;mark&gt;       Highlighted/relevant text</code>
</div>

<p><strong>Page structure example:</strong></p>

<div class="code-block" data-lang="HTML">
<code>&lt;body&gt;
    &lt;header&gt;
        &lt;nav aria-label="Main"&gt;...&lt;/nav&gt;
    &lt;/header&gt;
    
    &lt;main&gt;
        &lt;article&gt;
            &lt;h1&gt;Luna Silver Ring&lt;/h1&gt;
            &lt;section&gt;
                &lt;h2&gt;Product Details&lt;/h2&gt;
                ...
            &lt;/section&gt;
            &lt;section&gt;
                &lt;h2&gt;Reviews&lt;/h2&gt;
                ...
            &lt;/section&gt;
        &lt;/article&gt;
        
        &lt;aside&gt;
            &lt;h2&gt;Related Products&lt;/h2&gt;
            ...
        &lt;/aside&gt;
    &lt;/main&gt;
    
    &lt;footer&gt;...&lt;/footer&gt;
&lt;/body&gt;</code>
</div>

<h2>3. Heading Hierarchy</h2>

<p>Headings create a document outline. Must be hierarchical‚Äînever skip levels:</p>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Correct hierarchy --&gt;
&lt;h1&gt;Luna Silver Ring&lt;/h1&gt;
    &lt;h2&gt;Product Details&lt;/h2&gt;
        &lt;h3&gt;Materials&lt;/h3&gt;
        &lt;h3&gt;Sizing Guide&lt;/h3&gt;
    &lt;h2&gt;Customer Reviews&lt;/h2&gt;
        &lt;h3&gt;5-Star Reviews&lt;/h3&gt;

&lt;!-- WRONG: Skipping levels --&gt;
&lt;h1&gt;Product&lt;/h1&gt;
&lt;h4&gt;Details&lt;/h4&gt;  &lt;!-- Jumped from h1 to h4! --&gt;</code>
</div>

<p><strong>Rules:</strong> One h1 per page (the main topic). Don't skip levels. Headings aren't for styling‚Äîuse CSS for size.</p>

<h2>4. Accessibility Fundamentals</h2>

<h3>Alternative Text for Images</h3>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Informative image: Describe content --&gt;
&lt;img src="luna-ring.jpg" alt="Luna silver ring with twisted band design"&gt;

&lt;!-- Decorative image: Empty alt --&gt;
&lt;img src="decorative-swirl.png" alt=""&gt;

&lt;!-- Complex image: Longer description --&gt;
&lt;img src="size-chart.png" alt="Ring size chart" 
     aria-describedby="size-desc"&gt;
&lt;p id="size-desc"&gt;Sizes range from K (15.7mm) to S (19.0mm)...&lt;/p&gt;

&lt;!-- NEVER do this --&gt;
&lt;img src="ring.jpg"&gt;  &lt;!-- Missing alt --&gt;
&lt;img src="ring.jpg" alt="image"&gt;  &lt;!-- Useless alt --&gt;</code>
</div>

<h3>Form Labels</h3>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Explicit label association --&gt;
&lt;label for="email"&gt;Email Address&lt;/label&gt;
&lt;input type="email" id="email" name="email" required&gt;

&lt;!-- Implicit (wrapping) --&gt;
&lt;label&gt;
    Email Address
    &lt;input type="email" name="email" required&gt;
&lt;/label&gt;

&lt;!-- NEVER: Placeholder as only label --&gt;
&lt;input type="email" placeholder="Email"&gt;  &lt;!-- Disappears on focus! --&gt;</code>
</div>

<h3>Focus Management</h3>

<div class="code-block" data-lang="CSS">
<code>/* NEVER remove focus outline without replacement */
:focus { outline: none; }  /* BAD */

/* Provide visible focus indicator */
:focus { 
    outline: 2px solid #00d4aa; 
    outline-offset: 2px; 
}

/* Or use focus-visible for keyboard-only */
:focus-visible {
    outline: 2px solid #00d4aa;
}</code>
</div>

<h2>5. ARIA: When HTML Isn't Enough</h2>

<p>ARIA (Accessible Rich Internet Applications) adds accessibility information when native HTML semantics are insufficient:</p>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Roles: What is this element? --&gt;
&lt;div role="alert"&gt;Item added to cart&lt;/div&gt;
&lt;div role="dialog" aria-modal="true"&gt;...&lt;/div&gt;

&lt;!-- States: Current condition --&gt;
&lt;button aria-expanded="false" aria-controls="menu"&gt;Menu&lt;/button&gt;
&lt;input aria-invalid="true" aria-describedby="error-msg"&gt;

&lt;!-- Properties: Relationships --&gt;
&lt;nav aria-label="Main navigation"&gt;
&lt;nav aria-label="Footer links"&gt;

&lt;!-- Live regions: Announce dynamic changes --&gt;
&lt;div aria-live="polite"&gt;3 items in cart&lt;/div&gt;
&lt;div aria-live="assertive"&gt;Error: Payment failed&lt;/div&gt;</code>
</div>

<div class="info-box warning">
    <div class="info-box-title">‚ö†Ô∏è First Rule of ARIA</div>
    <p>Don't use ARIA if native HTML works. A &lt;button&gt; is better than &lt;div role="button"&gt;. Native elements have built-in keyboard handling, focus management, and semantics. ARIA is for custom components only.</p>
</div>

<h2>6. Testing Accessibility</h2>

<ul>
    <li><strong>Keyboard navigation:</strong> Can you complete checkout using only Tab, Enter, Space, Arrow keys?</li>
    <li><strong>Screen reader:</strong> Test with VoiceOver (Mac), NVDA (Windows free), or browser extensions</li>
    <li><strong>Automated tools:</strong> Lighthouse, axe DevTools, WAVE browser extension</li>
    <li><strong>Color contrast:</strong> WCAG requires 4.5:1 for normal text, 3:1 for large text</li>
    <li><strong>Zoom test:</strong> Does the site work at 200% browser zoom?</li>
</ul>

<div class="info-box">
    <div class="info-box-title">üí° Business Case for Accessibility</div>
    <p><strong>Legal:</strong> Many countries require accessibility (ADA in US, Equality Act in UK). Lawsuits are increasing.</p>
    <p><strong>Market:</strong> 15-20% of population has disabilities. That's customers you're excluding.</p>
    <p><strong>SEO:</strong> Many accessibility practices improve search rankings (semantic HTML, alt text, heading structure).</p>
    <p><strong>Mobile:</strong> Accessibility features often help all users (larger touch targets, clear labels).</p>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: Accessibility Audit</div>
    <ol>
        <li>Run Lighthouse accessibility audit on your product page</li>
        <li>Navigate your checkout using only keyboard (Tab, Enter, Escape)</li>
        <li>Check all product images have meaningful alt text</li>
        <li>Verify form fields have visible labels, not just placeholders</li>
        <li>Check color contrast on your primary CTA buttons</li>
    </ol>
</div>
`, 
            questions: [
                { q: "Your product page has h1, then jumps to h4 for sections. What's the problem?", options: ["Nothing‚Äîh4 is fine for smaller text", "Heading levels should be sequential (h1‚Üíh2‚Üíh3). Skipping breaks document outline for screen readers and hurts SEO.", "h4 is deprecated", "Should use h2 everywhere"], correct: 1, explanation: "Heading hierarchy must be sequential. Screen readers use headings for navigation and announce the level. Skipping from h1 to h4 suggests missing sections and breaks the document outline." },
                { q: "A decorative flourish image appears between sections. What should the alt attribute be?", options: ["alt='decorative flourish'", "alt='' (empty)", "No alt attribute at all", "alt='image'"], correct: 1, explanation: "Decorative images that add no information should have empty alt (alt=''). This tells screen readers to skip it entirely. Missing alt is an error. Describing decoration wastes users' time." },
                { q: "Your 'Add to Cart' button is a styled div with onclick handler. A keyboard user reports they can't activate it. Why?", options: ["They need a better keyboard", "div elements aren't focusable or keyboard-activatable by default. Use a real button element or add tabindex='0' and keyboard event handlers.", "JavaScript is disabled", "CSS is hiding it"], correct: 1, explanation: "Native button elements are focusable and respond to Enter/Space by default. div elements need tabindex='0' to be focusable, plus keydown handlers for Enter/Space. Always prefer semantic HTML." },
                { q: "Developer uses placeholder='Email address' with no visible label. Why is this problematic?", options: ["Placeholders are fine as labels", "Placeholders disappear when typing begins, leaving users with no reference for what the field is. Always use visible labels.", "Placeholders are deprecated", "It affects SEO"], correct: 1, explanation: "Placeholders disappear on focus/input. Users with cognitive disabilities, or anyone who looks away, lose context. Placeholders are hints, not labels. Always have a visible, associated label." },
                { q: "You want to announce 'Item added to cart' to screen reader users when they click Add to Cart. What's the approach?", options: ["Use alert() popup", "Use aria-live='polite' region‚Äîupdate its content and screen readers will announce it", "Write to console.log", "Just show it visually"], correct: 1, explanation: "aria-live regions announce content changes to screen readers. 'polite' waits for a pause in speech, 'assertive' interrupts immediately. Update the text content and screen readers announce it automatically." }
            ], 
            essay: { 
                question: "Your ecommerce site needs to meet WCAG 2.1 Level AA compliance for a major B2B contract. Outline an accessibility remediation plan covering: how you'd audit current issues, priority order for fixes, specific technical changes needed, testing methodology, and ongoing processes to prevent regression.", 
                guidance: "Cover: automated audit (Lighthouse, axe), manual testing (keyboard navigation, screen reader), prioritize by user impact (checkout flow > product pages > footer), specific fixes (semantic HTML, alt text, form labels, focus indicators, color contrast, skip links), testing with real assistive tech users if possible, developer training, CI/CD checks to prevent regression." 
            } 
        },
        { 
            day: 9, 
            title: "CSS Architecture & Methodologies", 
            desc: "BEM, CSS Modules, and managing stylesheets", 
            duration: "45 min", 
            content: `
<h2>Today's Learning Objectives</h2>
<p>CSS is deceptively simple to start but becomes a maintenance nightmare at scale. Today you'll learn methodologies that keep CSS manageable across large codebases and teams, and understand the problems they solve.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. The CSS Specificity Problem</li>
        <li>2. BEM Naming Convention</li>
        <li>3. CSS Custom Properties (Variables)</li>
        <li>4. Responsive Design Patterns</li>
        <li>5. Modern CSS Layout</li>
        <li>6. CSS Organization at Scale</li>
    </ul>
</div>

<h2>1. The CSS Specificity Problem</h2>

<p>CSS specificity determines which styles win when multiple rules target the same element:</p>

<div class="code-block" data-lang="CSS Specificity">
<code>/* Specificity hierarchy (highest to lowest) */
1. !important                    /* Nuclear option‚Äîavoid! */
2. Inline styles (style="...")   /* Avoid in production */
3. ID selectors (#header)        /* High specificity */
4. Class selectors (.nav)        /* Preferred */
5. Element selectors (div, p)    /* Low specificity */

/* The specificity war: */
.button { background: blue; }
.header .button { background: red; }      /* More specific, wins */
#nav .header .button { background: green; } /* Even more */
.button { background: yellow !important; }  /* Nuclear option */

/* This escalates until everything needs !important */</code>
</div>

<p>The problem: as codebases grow, developers add more specific selectors to override existing styles. Eventually you're fighting specificity wars, and !important becomes the only way to win‚Äîuntil someone adds !important to the other rule.</p>

<h2>2. BEM Naming Convention</h2>

<p>BEM (Block Element Modifier) eliminates specificity issues through naming conventions:</p>

<div class="code-block" data-lang="BEM">
<code>/* Block: Standalone component */
.product-card { }

/* Element: Part of block (double underscore) */
.product-card__image { }
.product-card__title { }
.product-card__price { }
.product-card__button { }

/* Modifier: Variant (double hyphen) */
.product-card--featured { }
.product-card--sold-out { }
.product-card__button--disabled { }
.product-card__price--sale { }</code>
</div>

<p><strong>HTML usage:</strong></p>

<div class="code-block" data-lang="HTML">
<code>&lt;article class="product-card product-card--featured"&gt;
    &lt;img class="product-card__image" src="..." alt="..."&gt;
    &lt;h3 class="product-card__title"&gt;Luna Ring&lt;/h3&gt;
    &lt;span class="product-card__price product-card__price--sale"&gt;
        ¬£24.99
    &lt;/span&gt;
    &lt;button class="product-card__button"&gt;Add to Cart&lt;/button&gt;
&lt;/article&gt;</code>
</div>

<p><strong>BEM Benefits:</strong></p>
<ul>
    <li><strong>Flat specificity:</strong> Single class selector = predictable, easy to override</li>
    <li><strong>Self-documenting:</strong> product-card__price clearly belongs to product-card</li>
    <li><strong>Isolation:</strong> Each block is independent‚Äîno cascade surprises</li>
    <li><strong>Searchability:</strong> Find all product-card styles by searching .product-card</li>
</ul>

<h2>3. CSS Custom Properties (Variables)</h2>

<p>CSS variables (custom properties) enable consistent design systems:</p>

<div class="code-block" data-lang="CSS">
<code>:root {
    /* Colors */
    --color-primary: #00d4aa;
    --color-secondary: #ff6b35;
    --color-text: #1a1a2e;
    --color-text-muted: #6b7280;
    --color-background: #ffffff;
    
    /* Spacing scale */
    --space-xs: 0.25rem;  /* 4px */
    --space-sm: 0.5rem;   /* 8px */
    --space-md: 1rem;     /* 16px */
    --space-lg: 2rem;     /* 32px */
    --space-xl: 4rem;     /* 64px */
    
    /* Typography */
    --font-sans: 'Inter', system-ui, sans-serif;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.25rem;
    
    /* Borders */
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 16px;
}

.button {
    background: var(--color-primary);
    padding: var(--space-sm) var(--space-md);
    border-radius: var(--radius-md);
    font-family: var(--font-sans);
}

/* Dark theme override */
.dark-theme {
    --color-text: #ffffff;
    --color-background: #1a1a2e;
}</code>
</div>

<p><strong>Why CSS variables over Sass variables?</strong> CSS variables work at runtime‚Äîthey cascade, inherit, and can be changed via JavaScript. Sass variables compile away to static values.</p>

<h2>4. Responsive Design Patterns</h2>

<p><strong>Mobile-first:</strong> Write base styles for mobile, then add complexity for larger screens:</p>

<div class="code-block" data-lang="CSS">
<code>/* Base: Mobile (smallest screens) */
.product-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-md);
}

/* Tablet: 640px+ */
@media (min-width: 640px) {
    .product-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Desktop: 1024px+ */
@media (min-width: 1024px) {
    .product-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}</code>
</div>

<p><strong>Why mobile-first?</strong> Start simple, progressively enhance. Mobile styles are typically simpler (single column, stacked elements). This approach results in cleaner CSS and better mobile performance.</p>

<h2>5. Modern CSS Layout</h2>

<h3>Flexbox: One-dimensional layouts</h3>

<div class="code-block" data-lang="CSS">
<code>.header {
    display: flex;
    justify-content: space-between; /* Horizontal distribution */
    align-items: center;            /* Vertical alignment */
    gap: var(--space-md);           /* Space between items */
}

.nav {
    display: flex;
    gap: var(--space-sm);
}

/* Responsive: Stack on mobile */
@media (max-width: 640px) {
    .header {
        flex-direction: column;
    }
}</code>
</div>

<h3>Grid: Two-dimensional layouts</h3>

<div class="code-block" data-lang="CSS">
<code>.product-page {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-areas:
        "images details"
        "reviews reviews";
    gap: var(--space-lg);
}

.product-images { grid-area: images; }
.product-details { grid-area: details; }
.product-reviews { grid-area: reviews; }

@media (max-width: 768px) {
    .product-page {
        grid-template-columns: 1fr;
        grid-template-areas:
            "images"
            "details"
            "reviews";
    }
}</code>
</div>

<h2>6. CSS Organization at Scale</h2>

<div class="code-block" data-lang="File Structure">
<code>styles/
‚îú‚îÄ‚îÄ base/
‚îÇ   ‚îú‚îÄ‚îÄ reset.css        /* Normalize browser defaults */
‚îÇ   ‚îú‚îÄ‚îÄ typography.css   /* Font styles, headings */
‚îÇ   ‚îî‚îÄ‚îÄ variables.css    /* Custom properties */
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ button.css
‚îÇ   ‚îú‚îÄ‚îÄ card.css
‚îÇ   ‚îú‚îÄ‚îÄ form.css
‚îÇ   ‚îî‚îÄ‚îÄ modal.css
‚îú‚îÄ‚îÄ layouts/
‚îÇ   ‚îú‚îÄ‚îÄ header.css
‚îÇ   ‚îú‚îÄ‚îÄ footer.css
‚îÇ   ‚îî‚îÄ‚îÄ grid.css
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ home.css
‚îÇ   ‚îú‚îÄ‚îÄ product.css
‚îÇ   ‚îî‚îÄ‚îÄ checkout.css
‚îî‚îÄ‚îÄ main.css             /* Imports all above */</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: CSS Audit</div>
    <ol>
        <li>Search your CSS for !important‚Äîhow many instances?</li>
        <li>Look for deeply nested selectors (4+ levels)</li>
        <li>Check if there's a consistent naming convention</li>
        <li>Are CSS variables used for colors and spacing?</li>
        <li>Test your site at different viewport widths</li>
    </ol>
</div>
`, 
            questions: [
                { q: "Your CSS has 50+ uses of !important. What does this indicate?", options: ["Normal practice for large sites", "Specificity wars‚Äîstyles kept overriding each other, developers escalated to !important. Indicates need for flatter selectors.", "CSS framework requirement", "Good defensive coding"], correct: 1, explanation: "Excessive !important is a symptom of specificity problems. Each use often triggers another, escalating until everything needs !important. BEM and flat selectors prevent this." },
                { q: "In BEM, what does .product-card__price--sale represent?", options: ["A sale page element", "The price element of the product-card block, with the sale modifier applied", "A child component of price", "Invalid BEM syntax"], correct: 1, explanation: "BEM: Block (product-card), Element (__price), Modifier (--sale). This is the price element within a product-card, with a variant style for sale items." },
                { q: "Why use CSS custom properties instead of Sass variables?", options: ["They compile to smaller CSS", "They're runtime variables‚Äîcan be changed via JS, cascade and inherit, enable theming without recompilation", "Sass is deprecated", "Better browser support"], correct: 1, explanation: "CSS custom properties work at runtime. They cascade (child elements inherit), can be changed via JavaScript (for themes), and respond to media queries. Sass variables compile to static values." },
                { q: "Mobile-first CSS means:", options: ["Only supporting mobile devices", "Writing base styles for mobile, then using min-width media queries to enhance for larger screens", "Mobile users get priority loading", "Separate mobile stylesheet"], correct: 1, explanation: "Mobile-first: base CSS for mobile (simplest layout), then min-width queries add complexity for larger screens. Results in simpler, more maintainable CSS and better mobile performance." },
                { q: "Deep selector like .page .sidebar .nav .list .item a causes what problems?", options: ["Slow CSS parsing", "High specificity making overrides difficult, plus tight coupling to HTML structure", "Invalid CSS", "Memory issues"], correct: 1, explanation: "Deep nesting creates high specificity (hard to override without more nesting or !important) and tightly couples CSS to HTML structure. Changing HTML breaks styles. BEM keeps selectors flat (single class)." }
            ], 
            essay: { 
                question: "Your team's CSS has grown to 15,000 lines with no conventions. Developers complain about styles breaking unexpectedly and difficulty overriding existing styles. Propose a plan to introduce BEM naming, establish a design token system with CSS variables, and gradually refactor without breaking production.", 
                guidance: "Cover: audit current state (identify most problematic areas), establish design tokens (colors, spacing, typography as CSS variables), create BEM style guide with examples, refactor component by component starting with isolated components, use feature flags or parallel stylesheets during transition, add stylelint to enforce conventions on new code, training sessions for team." 
            } 
        },
        { 
            day: 10, 
            title: "Core Web Vitals & Performance", 
            desc: "LCP, INP, CLS and optimization strategies", 
            duration: "50 min", 
            content: `
<h2>Today's Learning Objectives</h2>
<p>Google's Core Web Vitals are now ranking factors, and performance directly impacts conversions‚Äîevery 100ms of latency costs approximately 1% of sales. Today you'll understand how to measure and improve real-world performance.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Core Web Vitals Explained</li>
        <li>2. Largest Contentful Paint (LCP)</li>
        <li>3. Interaction to Next Paint (INP)</li>
        <li>4. Cumulative Layout Shift (CLS)</li>
        <li>5. Image Optimization</li>
        <li>6. JavaScript Performance</li>
        <li>7. Measuring Performance</li>
    </ul>
</div>

<h2>1. Core Web Vitals Explained</h2>

<p>Core Web Vitals are Google's metrics for user experience, measuring loading, interactivity, and visual stability:</p>

<div class="code-block" data-lang="Metrics">
<code>LCP (Largest Contentful Paint)
‚îú‚îÄ‚îÄ What: When main content becomes visible
‚îú‚îÄ‚îÄ Target: Under 2.5 seconds
‚îî‚îÄ‚îÄ Measures: Loading performance

INP (Interaction to Next Paint)
‚îú‚îÄ‚îÄ What: Response time to user interactions
‚îú‚îÄ‚îÄ Target: Under 200 milliseconds
‚îî‚îÄ‚îÄ Measures: Interactivity (replaced FID in 2024)

CLS (Cumulative Layout Shift)
‚îú‚îÄ‚îÄ What: How much page elements move during load
‚îú‚îÄ‚îÄ Target: Under 0.1
‚îî‚îÄ‚îÄ Measures: Visual stability</code>
</div>

<h2>2. Largest Contentful Paint (LCP)</h2>

<p>LCP measures when the largest content element becomes visible. This is usually:</p>
<ul>
    <li>Hero images</li>
    <li>Large text blocks (h1, main paragraph)</li>
    <li>Video poster images</li>
    <li>Background images with significant area</li>
</ul>

<p><strong>Common LCP problems:</strong></p>

<div class="code-block" data-lang="LCP Issues">
<code>1. Slow server response (TTFB > 600ms)
   ‚Üí Optimize server, use CDN, caching

2. Render-blocking resources
   ‚Üí Defer non-critical CSS/JS

3. Large unoptimized images
   ‚Üí Compress, resize, modern formats (WebP/AVIF)

4. Late-loading hero image
   ‚Üí Preload LCP image, avoid lazy-loading above fold

5. Web fonts blocking render
   ‚Üí Use font-display: swap, preload fonts</code>
</div>

<p><strong>LCP optimization:</strong></p>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Preload LCP image --&gt;
&lt;link rel="preload" as="image" href="hero.jpg" 
      fetchpriority="high"&gt;

&lt;!-- Priority hint on LCP image --&gt;
&lt;img src="hero.jpg" fetchpriority="high" alt="..."&gt;

&lt;!-- Preload critical font --&gt;
&lt;link rel="preload" as="font" type="font/woff2" 
      href="font.woff2" crossorigin&gt;</code>
</div>

<h2>3. Interaction to Next Paint (INP)</h2>

<p>INP measures how quickly the page responds to user interactions (clicks, taps, key presses). Poor INP means the site feels sluggish or unresponsive.</p>

<p><strong>Common INP problems:</strong></p>

<div class="code-block" data-lang="INP Issues">
<code>1. Long JavaScript tasks blocking main thread
   ‚Üí Break up long tasks, use requestIdleCallback

2. Excessive DOM size (> 1500 nodes)
   ‚Üí Simplify markup, virtualize long lists

3. Heavy event handlers
   ‚Üí Debounce/throttle, move work off main thread

4. Too much JavaScript
   ‚Üí Code split, defer non-critical scripts

5. Third-party scripts
   ‚Üí Audit impact, load async, consider removal</code>
</div>

<h2>4. Cumulative Layout Shift (CLS)</h2>

<p>CLS measures visual stability‚Äîhow much page elements move around during load. Ever tried to click a button and it jumped away? That's layout shift.</p>

<p><strong>Common CLS causes:</strong></p>

<div class="code-block" data-lang="CLS Issues">
<code>1. Images without dimensions
   ‚Üí Always set width and height attributes

2. Ads/embeds without reserved space
   ‚Üí Reserve space with min-height or aspect-ratio

3. Web fonts causing text reflow
   ‚Üí Use font-display: swap with similar fallback

4. Dynamically injected content
   ‚Üí Reserve space or insert above viewport

5. Animations that trigger layout
   ‚Üí Use transform/opacity, not width/height/top/left</code>
</div>

<p><strong>CLS prevention:</strong></p>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Always set dimensions on images --&gt;
&lt;img src="product.jpg" width="400" height="300" alt="..."&gt;

&lt;!-- Or use aspect-ratio in CSS --&gt;
&lt;style&gt;
.product-image {
    aspect-ratio: 4 / 3;
    width: 100%;
}
&lt;/style&gt;

&lt;!-- Reserve space for ads --&gt;
&lt;div class="ad-container" style="min-height: 250px;"&gt;
    &lt;!-- Ad loads here --&gt;
&lt;/div&gt;</code>
</div>

<h2>5. Image Optimization</h2>

<p>Images are typically the largest assets on ecommerce sites:</p>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Responsive images with srcset --&gt;
&lt;img 
    srcset="product-400.jpg 400w,
            product-800.jpg 800w,
            product-1200.jpg 1200w"
    sizes="(max-width: 640px) 100vw,
           (max-width: 1024px) 50vw,
           400px"
    src="product-800.jpg"
    alt="Luna Ring"
    width="400" height="400"
    loading="lazy"&gt;

&lt;!-- Modern formats with fallback --&gt;
&lt;picture&gt;
    &lt;source srcset="product.avif" type="image/avif"&gt;
    &lt;source srcset="product.webp" type="image/webp"&gt;
    &lt;img src="product.jpg" alt="Luna Ring"&gt;
&lt;/picture&gt;

&lt;!-- Lazy load below-fold images --&gt;
&lt;img src="related.jpg" loading="lazy" alt="..."&gt;

&lt;!-- DON'T lazy load LCP/above-fold images --&gt;
&lt;img src="hero.jpg" fetchpriority="high" alt="..."&gt;</code>
</div>

<p><strong>Format comparison:</strong></p>
<ul>
    <li><strong>JPEG:</strong> Photos, universal support, ~100% baseline</li>
    <li><strong>WebP:</strong> 25-35% smaller than JPEG, 95%+ browser support</li>
    <li><strong>AVIF:</strong> 50% smaller than JPEG, 85% browser support</li>
</ul>

<h2>6. JavaScript Performance</h2>

<div class="code-block" data-lang="HTML">
<code>&lt;!-- Defer non-critical scripts (loads parallel, executes after HTML) --&gt;
&lt;script src="analytics.js" defer&gt;&lt;/script&gt;

&lt;!-- Async for independent scripts (loads parallel, executes when ready) --&gt;
&lt;script src="chat-widget.js" async&gt;&lt;/script&gt;

&lt;!-- Critical CSS inline, rest deferred --&gt;
&lt;style&gt;/* Critical above-fold CSS */&lt;/style&gt;
&lt;link rel="preload" href="full.css" as="style" 
      onload="this.rel='stylesheet'"&gt;

&lt;!-- Module scripts are deferred by default --&gt;
&lt;script type="module" src="app.js"&gt;&lt;/script&gt;</code>
</div>

<h2>7. Measuring Performance</h2>

<p><strong>Lab tools (controlled testing):</strong></p>
<ul>
    <li><strong>Lighthouse:</strong> DevTools ‚Üí Lighthouse tab ‚Üí Generate report</li>
    <li><strong>WebPageTest:</strong> Test from different locations and connections</li>
    <li><strong>Chrome DevTools Performance:</strong> Record and analyze timeline</li>
</ul>

<p><strong>Field data (real users):</strong></p>
<ul>
    <li><strong>PageSpeed Insights:</strong> Shows real user data from Chrome UX Report</li>
    <li><strong>Search Console:</strong> Core Web Vitals report for your whole site</li>
    <li><strong>Web Vitals Extension:</strong> Real-time CWV as you browse</li>
</ul>

<div class="info-box">
    <div class="info-box-title">üí° Lab vs Field Data</div>
    <p><strong>Lab data</strong> (Lighthouse) tests in controlled conditions‚Äîuseful for debugging but doesn't reflect real-user experience.</p>
    <p><strong>Field data</strong> (PageSpeed Insights, Search Console) shows actual user experience across devices and connections. This is what Google uses for ranking.</p>
    <p>Your site might score 95 in Lighthouse but fail field metrics because real users have slower devices and connections.</p>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: Performance Audit</div>
    <ol>
        <li>Run PageSpeed Insights on your product page (mobile mode)</li>
        <li>Note your LCP, INP, CLS scores‚Äîare they passing?</li>
        <li>Identify the LCP element using DevTools Performance panel</li>
        <li>Check for images without width/height attributes</li>
        <li>Look at Network tab‚Äîare images optimized? Using modern formats?</li>
    </ol>
</div>
`, 
            questions: [
                { q: "Your LCP is 4.5 seconds, target is 2.5. What should you investigate first?", options: ["CLS optimization", "Server response time (TTFB), render-blocking resources, hero image size and loading strategy", "Adding more content", "JavaScript bundle size"], correct: 1, explanation: "LCP of 4.5s is poor. Investigate: TTFB (is server slow?), render-blocking CSS/JS (delaying render), hero image (too large? not preloaded? lazy-loaded incorrectly?), font loading blocking text paint." },
                { q: "Product images load without width/height, causing content to jump. Which metric is affected?", options: ["LCP", "INP", "CLS‚Äîlayout shifts when images load and push content around", "TTFB"], correct: 2, explanation: "CLS (Cumulative Layout Shift) measures visual stability. Images without dimensions cause layout shifts when they load. Always set width and height attributes or use CSS aspect-ratio." },
                { q: "Analytics script delays page interactivity. What attribute helps?", options: ["src", "defer or async‚Äîloads script without blocking HTML parsing", "type", "integrity"], correct: 1, explanation: "defer loads script in parallel with HTML parsing, executes after HTML is complete. async loads in parallel, executes immediately when ready. Both prevent blocking the parser and improve interactivity." },
                { q: "You're serving 2MB JPEGs for product images. Better approach?", options: ["They're fine for quality", "Resize appropriately, use modern formats (WebP/AVIF), implement srcset for responsive images, lazy load below-fold", "Just compress to 10% quality", "Remove images"], correct: 1, explanation: "2MB images are far too large. Serve appropriately sized images (srcset), use modern formats (WebP 30% smaller, AVIF 50% smaller), lazy load below-fold images, compress appropriately." },
                { q: "Search Console shows Core Web Vitals failing for mobile. What's the business impact?", options: ["None‚Äîjust vanity metrics", "CWV are ranking signals. Poor mobile performance can reduce search rankings and definitely hurts conversion rates.", "Site will be delisted", "Only affects ads"], correct: 1, explanation: "Core Web Vitals are Google ranking signals for mobile search. Poor CWV can reduce rankings. More directly, poor performance hurts conversions‚Äîusers leave slow sites." }
            ], 
            essay: { 
                question: "Your ecommerce site scores 45 on mobile Lighthouse (should be 90+). LCP is 5.8s, CLS is 0.35, INP is 380ms. Create a prioritized performance improvement plan covering: diagnostic steps, quick wins, medium-term improvements, and how to prevent regression.", 
                guidance: "Cover: diagnostics (WebPageTest waterfall, DevTools Performance, identify LCP element, find layout shift sources), quick wins (image optimization, lazy loading, font-display: swap, defer scripts), medium-term (code splitting, critical CSS, image CDN, server optimization), monitoring (Real User Monitoring, performance budgets, Lighthouse CI in deployment pipeline)." 
            } 
        },
        { 
            day: 11, 
            title: "JavaScript Fundamentals", 
            desc: "JS for non-developers: reading and debugging", 
            duration: "50 min", 
            content: `
<h2>Today's Learning Objectives</h2>
<p>You don't need to write production JavaScript, but understanding how it works helps you debug issues, evaluate technical proposals, and communicate effectively with developers. Today covers practical JavaScript literacy.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Variables and Data Types</li>
        <li>2. Functions</li>
        <li>3. Objects and Arrays</li>
        <li>4. Control Flow</li>
        <li>5. Asynchronous JavaScript</li>
        <li>6. Debugging in DevTools</li>
    </ul>
</div>

<h2>1. Variables and Data Types</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Variable declarations
const MAX_ITEMS = 10;       // Constant - cannot be reassigned
let itemCount = 0;          // Let - can be reassigned
var oldStyle = 'avoid';     // Var - old way, avoid using

// Data types
const productName = "Luna Ring";           // String (text)
const price = 24.99;                       // Number
const inStock = true;                      // Boolean (true/false)
const tags = ["silver", "ring", "wedding"]; // Array (list)
const product = {                          // Object (key-value pairs)
    id: 456,
    name: "Luna Ring",
    price: 24.99
};
const nothing = null;                      // Null - intentionally empty
let notDefined;                            // Undefined - not yet set</code>
</div>

<p><strong>const vs let:</strong> Use const by default (can't accidentally reassign). Use let when the value needs to change (counters, accumulators).</p>

<h2>2. Functions</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Traditional function declaration
function calculateTotal(price, quantity) {
    return price * quantity;
}

// Arrow function (modern, concise)
const calculateTotal = (price, quantity) => price * quantity;

// Arrow function with multiple lines
const formatPrice = (pence) => {
    const pounds = pence / 100;
    return '¬£' + pounds.toFixed(2);
};

// Calling functions
const total = calculateTotal(2499, 2);  // Returns 4998
const display = formatPrice(4998);       // Returns "¬£49.98"</code>
</div>

<h2>3. Objects and Arrays</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Objects: key-value pairs
const product = {
    id: 456,
    name: "Luna Ring",
    price: 2499,
    sizes: ["K", "L", "M"]
};

// Accessing object properties
product.name           // "Luna Ring"
product['name']        // "Luna Ring" (same thing)
product.sizes[0]       // "K" (first size)

// Arrays: ordered lists
const cart = [
    { productId: 456, quantity: 1 },
    { productId: 789, quantity: 2 }
];

// Array methods you'll see often
cart.length            // 2 (number of items)
cart[0]                // First item
cart.push(item)        // Add item to end
cart.filter(...)       // Filter items matching condition
cart.map(...)          // Transform each item
cart.find(...)         // Find first matching item
cart.forEach(...)      // Do something for each item</code>
</div>

<h2>4. Control Flow</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Conditionals
if (cart.length === 0) {
    showEmptyCartMessage();
} else if (cart.length < 3) {
    showSmallCartMessage();
} else {
    showFullCartMessage();
}

// Comparison operators
===   // Equals (use this, not ==)
!==   // Not equals
>     // Greater than
<     // Less than
>=    // Greater or equal
<=    // Less or equal
&&    // AND
||    // OR
!     // NOT

// Ternary operator (short if/else)
const message = inStock ? "Add to Cart" : "Out of Stock";

// Loops
for (let i = 0; i < items.length; i++) {
    console.log(items[i]);
}

// Modern loop (preferred)
items.forEach(item => {
    console.log(item.name);
});</code>
</div>

<h2>5. Asynchronous JavaScript</h2>

<p>Many operations take time (API calls, loading images). JavaScript uses async patterns so the page doesn't freeze while waiting.</p>

<div class="code-block" data-lang="JavaScript">
<code>// Promises with .then()
fetch('/api/cart')
    .then(response => response.json())
    .then(cart => {
        console.log('Cart has', cart.items.length, 'items');
    })
    .catch(error => {
        console.error('Failed to load cart:', error);
    });

// Async/await (cleaner syntax, same thing)
async function loadCart() {
    try {
        const response = await fetch('/api/cart');
        const cart = await response.json();
        console.log('Cart has', cart.items.length, 'items');
    } catch (error) {
        console.error('Failed to load cart:', error);
    }
}

// Key insight: Code after await doesn't run until the await completes
// This is how JS handles "waiting" without freezing</code>
</div>

<h2>6. Debugging in DevTools</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Console methods for debugging
console.log('Simple message');
console.log('Product:', product);     // Log objects
console.error('Something failed');    // Red error message
console.table(arrayOfObjects);        // Display as table
console.dir(element);                 // Expandable DOM element

// Breakpoints
debugger;  // Pauses execution here when DevTools is open

// In DevTools Console tab:
// - Type JavaScript directly to test
// - Access page variables
// - See errors in red

// In DevTools Sources tab:
// - View all JavaScript files
// - Click line numbers to set breakpoints
// - Step through code line by line
// - Inspect variable values at each step</code>
</div>

<div class="info-box">
    <div class="info-box-title">üí° Common Error Messages</div>
    <p><strong>"Uncaught TypeError: Cannot read property 'x' of undefined"</strong> ‚Äî Code tried to access .x on something that doesn't exist. Usually means an API response is missing expected data, or an element wasn't found.</p>
    <p><strong>"Uncaught ReferenceError: x is not defined"</strong> ‚Äî Using a variable that doesn't exist. Typo in variable name or forgot to declare it.</p>
    <p><strong>"Uncaught SyntaxError"</strong> ‚Äî Invalid JavaScript syntax. Missing bracket, quote, or semicolon.</p>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: JavaScript Exploration</div>
    <ol>
        <li>Open your site with DevTools Console tab</li>
        <li>Type: document.querySelectorAll('img').length (counts images)</li>
        <li>Type: document.querySelector('h1').textContent (gets h1 text)</li>
        <li>Look for any red error messages in Console</li>
        <li>Find a button and inspect its event listeners in Elements panel</li>
    </ol>
</div>
`, 
            questions: [
                { q: "Console shows 'Uncaught TypeError: Cannot read property length of undefined'. What happened?", options: ["Network error", "Code tried to access .length on something that doesn't exist (undefined). Usually means expected data is missing.", "CSS error", "Server error"], correct: 1, explanation: "This error means code expected an array or string (which have .length) but got undefined. Common causes: API didn't return expected data structure, element wasn't found on page, typo in property name." },
                { q: "What's the difference between const and let?", options: ["No difference", "const cannot be reassigned after declaration, let can be reassigned", "const is for numbers, let is for strings", "let is deprecated"], correct: 1, explanation: "const declares a constant that cannot be reassigned (const x = 5; x = 10 fails). let declares a variable that can be reassigned. Use const by default for safety." },
                { q: "What does async/await do?", options: ["Makes code run faster", "Handles operations that take time (API calls, file loading) without freezing the page", "Encrypts data", "Improves SEO"], correct: 1, explanation: "async/await handles asynchronous operations. Code pauses at await until the operation completes, but doesn't freeze the page‚Äîother code can run. Essential for API calls." },
                { q: "Developer says 'add an event listener for clicks'. What does this mean?", options: ["Install a browser extension", "Attach a function that runs when the user clicks an element‚ÄîaddEventListener('click', function)", "Add a CSS hover effect", "Create a log file"], correct: 1, explanation: "Event listeners are functions attached to elements that run when events occur (click, submit, keypress). addEventListener connects the element, event type, and handler function." },
                { q: "You see fetch('/api/cart').then(...).catch(...). What's the .catch() for?", options: ["Caching the response", "Error handling‚Äîruns if the fetch request fails", "Catching user input", "Performance optimization"], correct: 1, explanation: ".catch() handles errors in the promise chain. If the network request fails or the server returns an error status, the catch block runs instead of the .then() blocks." }
            ], 
            essay: { 
                question: "Your checkout page has a bug: the 'Place Order' button sometimes doesn't respond to clicks. How would you approach debugging this as a non-developer? Describe what you would check in DevTools, what information you would gather for developers, and what questions you would ask.", 
                guidance: "Cover: check Console for JavaScript errors (red messages), check Network tab for failed API requests, try to reproduce consistently (when exactly does it happen?), check if button shows visual feedback on click, look at Elements panel for the button's event listeners, gather browser/device info, create steps to reproduce, ask developers: Is there client-side validation failing? Is an API call timing out? Is there a race condition?" 
            } 
        },
        { 
            day: 12, 
            title: "DOM & Event Handling", 
            desc: "How JavaScript interacts with pages", 
            duration: "45 min", 
            content: `
<h2>Today's Learning Objectives</h2>
<p>Building on yesterday's JavaScript foundations, today we dive into how JavaScript actually manipulates web pages. Every interactive feature‚Äîcart updates, form validation, product galleries‚Äîuses these concepts.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. The DOM Tree</li>
        <li>2. Selecting Elements</li>
        <li>3. Modifying Elements</li>
        <li>4. Event Handling</li>
        <li>5. Event Delegation</li>
        <li>6. Common Patterns</li>
    </ul>
</div>

<h2>1. The DOM Tree</h2>

<p>The browser parses HTML into a tree structure called the DOM (Document Object Model). JavaScript can read and modify this tree.</p>

<div class="code-block" data-lang="DOM Tree">
<code>HTML:
&lt;body&gt;
    &lt;header&gt;
        &lt;nav&gt;&lt;a href="/"&gt;Home&lt;/a&gt;&lt;/nav&gt;
    &lt;/header&gt;
    &lt;main&gt;
        &lt;h1&gt;Products&lt;/h1&gt;
    &lt;/main&gt;
&lt;/body&gt;

Becomes DOM tree:
document
‚îî‚îÄ‚îÄ html
    ‚îî‚îÄ‚îÄ body
        ‚îú‚îÄ‚îÄ header
        ‚îÇ   ‚îî‚îÄ‚îÄ nav
        ‚îÇ       ‚îî‚îÄ‚îÄ a
        ‚îî‚îÄ‚îÄ main
            ‚îî‚îÄ‚îÄ h1

JavaScript accesses via: document.querySelector('h1')</code>
</div>

<h2>2. Selecting Elements</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Select single element (first match)
document.querySelector('.product-card');      // By class
document.querySelector('#main-nav');          // By ID
document.querySelector('article');            // By tag
document.querySelector('[data-product-id]');  // By attribute
document.querySelector('.card .price');       // Nested selector

// Select ALL matching elements (returns NodeList)
document.querySelectorAll('.product-card');
document.querySelectorAll('input[required]');

// Working with NodeList (like an array)
const cards = document.querySelectorAll('.product-card');
cards.length;           // Number of elements
cards[0];               // First element
cards.forEach(card => { /* do something */ });

// Traversing from an element
element.parentElement;           // Parent
element.children;                // Direct children
element.nextElementSibling;      // Next sibling
element.closest('.ancestor');    // Find ancestor matching selector</code>
</div>

<h2>3. Modifying Elements</h2>

<div class="code-block" data-lang="JavaScript">
<code>const card = document.querySelector('.product-card');

// Changing content
card.textContent = 'Plain text only';
card.innerHTML = '&lt;span&gt;Can include HTML&lt;/span&gt;';

// Changing attributes
card.setAttribute('data-product-id', '456');
card.getAttribute('data-product-id');  // '456'
card.dataset.productId;                // '456' (shorthand for data-*)

// Changing classes
card.classList.add('highlighted');
card.classList.remove('hidden');
card.classList.toggle('expanded');      // Add if absent, remove if present
card.classList.contains('highlighted'); // true

// Changing styles
card.style.backgroundColor = '#fff';
card.style.display = 'none';           // Hide element

// Creating new elements
const badge = document.createElement('span');
badge.textContent = 'Sale';
badge.className = 'badge badge--sale';
card.appendChild(badge);               // Add as last child
card.prepend(badge);                   // Add as first child

// Removing elements
element.remove();</code>
</div>

<h2>4. Event Handling</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Adding event listener
button.addEventListener('click', function(event) {
    console.log('Button clicked!');
    console.log(event.target);  // The element that was clicked
});

// Arrow function version
button.addEventListener('click', (e) => {
    e.preventDefault();  // Stop default behavior (form submit, link navigation)
    handleClick();
});

// Common events
'click'           // Mouse click
'submit'          // Form submission
'input'           // Input field value changes (fires on every keystroke)
'change'          // Select/checkbox changes, input on blur
'keydown'         // Key pressed
'keyup'           // Key released
'focus'           // Element receives focus
'blur'            // Element loses focus
'scroll'          // Page or element scrolled
'load'            // Resource finished loading
'DOMContentLoaded' // HTML parsed (before images load)

// Remove event listener
button.removeEventListener('click', handlerFunction);</code>
</div>

<h2>5. Event Delegation</h2>

<p>Instead of adding listeners to many elements, add one to their parent:</p>

<div class="code-block" data-lang="JavaScript">
<code>// BAD: Listener on every button (doesn't work for dynamic content)
document.querySelectorAll('.add-to-cart').forEach(btn => {
    btn.addEventListener('click', handleAddToCart);
});
// Problem: New buttons added later won't have listeners!

// GOOD: Event delegation to parent
document.querySelector('.product-grid').addEventListener('click', (e) => {
    // Find if click was on (or inside) an add-to-cart button
    const button = e.target.closest('.add-to-cart');
    if (button) {
        const productId = button.dataset.productId;
        addToCart(productId);
    }
});
// Works for all buttons, including dynamically added ones!

// How it works:
// 1. Click happens on child element
// 2. Event "bubbles up" through parent elements
// 3. Parent listener catches it
// 4. e.target tells us what was actually clicked
// 5. .closest() finds the button (even if click was on icon inside)</code>
</div>

<h2>6. Common Patterns</h2>

<div class="code-block" data-lang="JavaScript">
<code>// Form submission handling
form.addEventListener('submit', async (e) => {
    e.preventDefault();  // Stop page reload
    
    const formData = new FormData(form);
    const data = Object.fromEntries(formData);
    
    try {
        const response = await fetch('/api/submit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        
        if (response.ok) {
            showSuccess();
        } else {
            showError('Submission failed');
        }
    } catch (error) {
        showError('Network error');
    }
});

// Show/hide elements
function toggleModal() {
    modal.classList.toggle('is-visible');
}

// Update cart count
function updateCartCount(count) {
    document.querySelector('.cart-count').textContent = count;
}

// Debounce (limit how often function runs)
function debounce(func, wait) {
    let timeout;
    return (...args) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => func(...args), wait);
    };
}

// Use for search-as-you-type
searchInput.addEventListener('input', debounce(handleSearch, 300));</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: DOM Exploration</div>
    <p>In DevTools Console on your site:</p>
    <ol>
        <li>document.querySelectorAll('a').length ‚Äî how many links?</li>
        <li>document.querySelector('h1').textContent ‚Äî what's the main heading?</li>
        <li>Try: document.querySelector('h1').style.color = 'red'</li>
        <li>Find a button in Elements panel, check its Event Listeners tab</li>
    </ol>
</div>
`, 
            questions: [
                { q: "querySelectorAll('.product-card') returns what?", options: ["A single element", "A NodeList of all matching elements (similar to an array)", "A string", "An error if multiple match"], correct: 1, explanation: "querySelectorAll returns a NodeList containing all matching elements. querySelector returns only the first match. NodeList can be iterated with forEach or accessed by index." },
                { q: "Why use event delegation instead of listeners on each element?", options: ["It's faster to type", "One listener handles all matching elements, including ones added dynamically later. Better performance, works with dynamic content.", "Required by HTML5", "Looks cleaner in code"], correct: 1, explanation: "Event delegation means one listener on a parent handles events from all children (via bubbling). Benefits: works for dynamically added elements, fewer listeners = better memory, cleaner code." },
                { q: "e.preventDefault() in a form submit handler does what?", options: ["Deletes the form", "Stops the form from submitting normally (page reload), letting JavaScript handle it instead", "Validates the form", "Shows an error"], correct: 1, explanation: "preventDefault stops the browser's default action. For forms, that means no page reload/redirect. JavaScript can then handle submission via fetch (AJAX) without losing page state." },
                { q: "textContent vs innerHTML‚Äîwhen to use each?", options: ["They're the same", "textContent for plain text (safe), innerHTML when you need to insert HTML tags (security risk with user input)", "innerHTML is deprecated", "textContent is slower"], correct: 1, explanation: "textContent sets/gets plain text‚Äîsafe for any content. innerHTML parses HTML‚Äîuseful but dangerous with user input (XSS risk). Default to textContent; use innerHTML carefully." },
                { q: "element.closest('.ancestor') does what?", options: ["Finds the element closest to the mouse", "Traverses UP the DOM tree, returning first ancestor (or self) matching the selector", "Finds the nearest sibling", "Calculates distance in pixels"], correct: 1, explanation: "closest() walks up the DOM tree from the element, returning the first ancestor (including the element itself) that matches the selector. Essential for event delegation." }
            ], 
            essay: { 
                question: "Your product page has a quantity selector (+/- buttons and input), 'Add to Cart' button, and price display that should update based on quantity. Describe how these would work together using DOM manipulation and events. What events would you listen for? How would elements update? What edge cases need handling?", 
                guidance: "Cover: click events on +/- buttons, input event on quantity field, event delegation for buttons, reading/updating quantity input value, calculating and displaying updated price, disabling - at quantity 1, maximum quantity limits, input validation (numbers only, within stock), updating Add to Cart button state, accessibility considerations." 
            } 
        },
        { 
            day: 13, 
            title: "Frontend Build Tools", 
            desc: "Webpack, Vite, npm, and the build pipeline", 
            duration: "45 min", 
            content: `
<h2>Today's Learning Objectives</h2>
<p>Modern frontend development involves build tools that transform, bundle, and optimize code. Understanding this pipeline helps you interpret build errors, evaluate technical decisions, and understand why deployments work the way they do.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Why Build Tools Exist</li>
        <li>2. Package Managers (npm, yarn)</li>
        <li>3. Module Bundlers</li>
        <li>4. Transpilation</li>
        <li>5. The Build Pipeline</li>
        <li>6. Development vs Production</li>
    </ul>
</div>

<h2>1. Why Build Tools Exist</h2>

<p>Browsers understand HTML, CSS, and JavaScript. But modern development uses features browsers don't natively support:</p>

<div class="code-block" data-lang="Problems Build Tools Solve">
<code>Problem: Modern JavaScript features
‚Üí Transpile to older JavaScript for browser compatibility

Problem: Many small files (modules)
‚Üí Bundle into fewer files for fewer HTTP requests

Problem: Large file sizes
‚Üí Minify code, compress images, remove unused code

Problem: Sass/LESS for CSS
‚Üí Compile to standard CSS

Problem: TypeScript for type safety
‚Üí Compile to JavaScript

Problem: React/Vue components
‚Üí Compile JSX/templates to JavaScript</code>
</div>

<h2>2. Package Managers (npm, yarn, pnpm)</h2>

<p>Package managers install and manage third-party code (libraries, frameworks):</p>

<div class="code-block" data-lang="npm">
<code># package.json - defines project dependencies
{
    "name": "jewellery-store",
    "version": "1.0.0",
    "dependencies": {
        "react": "^18.2.0",     // Runtime dependency (used in browser)
        "stripe": "^12.0.0"
    },
    "devDependencies": {
        "webpack": "^5.88.0",   // Build-time only
        "typescript": "^5.0.0"
    },
    "scripts": {
        "dev": "vite",              // npm run dev
        "build": "vite build",      // npm run build
        "test": "jest"              // npm run test
    }
}

# Install all dependencies
npm install

# Add a new dependency
npm install lodash

# Add a dev dependency
npm install --save-dev typescript

# node_modules/ - where packages are installed (don't commit to git)
# package-lock.json - exact versions (do commit)</code>
</div>

<p><strong>Key files:</strong></p>
<ul>
    <li><strong>package.json:</strong> Project config and dependencies list</li>
    <li><strong>package-lock.json:</strong> Exact versions of all dependencies (ensures consistent installs)</li>
    <li><strong>node_modules/:</strong> Installed packages (often huge, don't commit to git)</li>
</ul>

<h2>3. Module Bundlers (Webpack, Vite, esbuild)</h2>

<p>Bundlers combine many JavaScript files into fewer optimized files:</p>

<div class="code-block" data-lang="Bundling">
<code>Input (development):
src/
‚îú‚îÄ‚îÄ index.js          // imports components
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Header.js     // imports utils, styles
‚îÇ   ‚îú‚îÄ‚îÄ ProductCard.js
‚îÇ   ‚îî‚îÄ‚îÄ Cart.js
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ formatPrice.js
‚îî‚îÄ‚îÄ styles/
    ‚îî‚îÄ‚îÄ main.css

‚Üì Bundler processes ‚Üì

Output (production):
dist/
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ main.a1b2c3.js    // All JS combined, minified, hashed
‚îú‚îÄ‚îÄ main.d4e5f6.css   // All CSS combined, minified, hashed
‚îî‚îÄ‚îÄ images/
    ‚îî‚îÄ‚îÄ logo.g7h8i9.png</code>
</div>

<p><strong>What bundlers do:</strong></p>
<ul>
    <li><strong>Bundle:</strong> Combine modules into fewer files</li>
    <li><strong>Minify:</strong> Remove whitespace, shorten variable names</li>
    <li><strong>Tree shake:</strong> Remove unused code</li>
    <li><strong>Code split:</strong> Create separate bundles loaded on demand</li>
    <li><strong>Hash filenames:</strong> main.a1b2c3.js for cache busting</li>
    <li><strong>Process assets:</strong> Optimize images, compile Sass</li>
</ul>

<h2>4. Transpilation</h2>

<p>Transpilers convert code from one form to another:</p>

<div class="code-block" data-lang="Transpilation">
<code>// Modern JavaScript (ES2020+)
const prices = products.map(p => p.price);
const total = prices.reduce((a, b) => a + b, 0);
const { name, price } = product;
async function loadData() { ... }

‚Üì Babel transpiles to ES5 ‚Üì

// Older JavaScript (works in IE11)
var prices = products.map(function(p) { return p.price; });
var total = prices.reduce(function(a, b) { return a + b; }, 0);
var name = product.name;
var price = product.price;
function loadData() { return regeneratorRuntime.async(...); }


// TypeScript
const price: number = 24.99;
interface Product { id: number; name: string; }

‚Üì TypeScript compiler ‚Üì

// JavaScript (types stripped out)
const price = 24.99;


// JSX (React)
&lt;Button onClick={handleClick}&gt;Buy Now&lt;/Button&gt;

‚Üì Babel transforms ‚Üì

// JavaScript
React.createElement(Button, { onClick: handleClick }, "Buy Now")</code>
</div>

<h2>5. The Build Pipeline</h2>

<div class="code-block" data-lang="Pipeline">
<code>Development workflow:
1. Developer saves file
2. File watcher detects change
3. Affected modules recompiled
4. Hot Module Replacement updates browser (no refresh)

Production build:
1. npm run build
2. Clean output directory
3. Compile TypeScript/JSX ‚Üí JavaScript
4. Bundle all modules together
5. Tree shake (remove unused exports)
6. Minify JavaScript and CSS
7. Optimize and compress images
8. Generate hashed filenames
9. Create source maps (for debugging)
10. Output to dist/ folder

Deployment:
1. Upload dist/ contents to CDN/server
2. Hashed filenames ensure cache busting
3. Old files can be cached forever</code>
</div>

<h2>6. Development vs Production</h2>

<div class="code-block" data-lang="Comparison">
<code>Development mode (npm run dev):
‚îú‚îÄ‚îÄ Fast rebuilds (incremental)
‚îú‚îÄ‚îÄ Source maps (debug original code)
‚îú‚îÄ‚îÄ Hot reloading (instant updates)
‚îú‚îÄ‚îÄ Verbose error messages
‚îú‚îÄ‚îÄ No minification (readable code)
‚îî‚îÄ‚îÄ Runs local dev server

Production mode (npm run build):
‚îú‚îÄ‚îÄ Full optimization
‚îú‚îÄ‚îÄ Minified and compressed
‚îú‚îÄ‚îÄ Tree shaking enabled
‚îú‚îÄ‚îÄ Code splitting
‚îú‚îÄ‚îÄ Hashed filenames
‚îî‚îÄ‚îÄ Outputs static files for deployment

// Environment variables
if (process.env.NODE_ENV === 'production') {
    // Production-only code
    enableAnalytics();
}</code>
</div>

<div class="info-box">
    <div class="info-box-title">üí° Common Build Issues</div>
    <p><strong>"Module not found"</strong> ‚Äî Package not installed. Run npm install.</p>
    <p><strong>"Cannot find module './component'"</strong> ‚Äî File path wrong or file doesn't exist.</p>
    <p><strong>Build succeeds locally, fails in CI</strong> ‚Äî Different Node versions, missing dependencies, or environment variable issues.</p>
    <p><strong>CSS not applying</strong> ‚Äî CSS modules, import order issues, or purging removing needed styles.</p>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise: Explore Your Build</div>
    <ol>
        <li>Find your project's package.json‚Äîwhat are the main dependencies?</li>
        <li>What scripts are defined? (dev, build, test?)</li>
        <li>Look at the build output (dist/ or build/)‚Äîwhat files are generated?</li>
        <li>Check file sizes‚Äîis JavaScript larger than 500KB?</li>
    </ol>
</div>
`, 
            questions: [
                { q: "Developer says 'npm install failed'. What's the first thing to check?", options: ["Internet connection", "Check for error message, ensure Node.js is installed, try deleting node_modules and package-lock.json then reinstall", "Restart computer", "Update npm"], correct: 1, explanation: "npm install failures have many causes. Read the error message first. Common fixes: delete node_modules and package-lock.json, ensure correct Node version, check for permission issues, verify package.json syntax." },
                { q: "What does 'tree shaking' do?", options: ["Reorganizes file structure", "Removes unused code/exports from the final bundle, reducing file size", "Sorts imports alphabetically", "Validates code syntax"], correct: 1, explanation: "Tree shaking statically analyzes ES6 module imports/exports and removes code that's never used. If you import one function from a library, only that function (and its dependencies) ends up in the bundle." },
                { q: "Build output has files like main.a1b2c3d4.js. Why the hash?", options: ["Security encryption", "Cache busting‚Äînew content gets a new hash, forcing browsers to download the new file instead of using cached version", "Compression identifier", "Random organization"], correct: 1, explanation: "Content hashing in filenames enables aggressive caching. Browsers can cache forever because when content changes, the filename changes. New deploy = new hash = fresh download." },
                { q: "Difference between dependencies and devDependencies in package.json?", options: ["No difference", "dependencies are needed at runtime (shipped to users), devDependencies are build-time only (bundlers, test tools)", "devDependencies are optional", "dependencies are more stable"], correct: 1, explanation: "dependencies (React, Stripe) are needed when the app runs. devDependencies (Webpack, TypeScript, Jest) are only needed during development/build‚Äîthey don't ship to users." },
                { q: "Site works locally but is broken in production. What build-related issues should you check?", options: ["Server is slow", "Environment variables missing, different Node versions, development-only code not stripped, API URLs not updated for production", "DNS issues", "Database connection"], correct: 1, explanation: "Dev vs prod differences: environment variables may differ (API keys, URLs), code might rely on dev-only features, optimizations might remove code that seemed unused, source maps might reveal issues hidden in dev." }
            ], 
            essay: { 
                question: "Your team is starting a new frontend project. The tech lead proposes using Vite instead of the existing Webpack setup. What factors should influence this decision? Consider build speed, ecosystem maturity, team familiarity, migration effort, and long-term maintainability.", 
                guidance: "Cover: Vite advantages (faster dev server, ES modules, simpler config), Webpack advantages (mature ecosystem, more plugins, proven at scale), migration considerations (config rewrite, plugin compatibility), team factors (learning curve, existing expertise), project factors (size, complexity, timeline), recommendation approach (try Vite for new project, evaluate before migrating existing)." 
            } 
        },
        {
            day: 14,
            title: "Frontend Frameworks Overview",
            desc: "React, Vue, and when to use frameworks",
            duration: "45 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Frontend frameworks like React, Vue, and Angular dominate modern web development. Today you'll understand what problems they solve, how they differ, and how to evaluate framework choices for your platform.</p>

<h2>1. Why Frameworks Exist</h2>

<p>Building interactive UIs with vanilla JavaScript becomes painful at scale. Frameworks provide:</p>
<ul>
    <li><strong>Declarative rendering:</strong> Describe what UI should look like, framework handles updates</li>
    <li><strong>Component model:</strong> Reusable, self-contained pieces</li>
    <li><strong>State management:</strong> Predictable data flow</li>
    <li><strong>Ecosystem:</strong> Routing, forms, testing, tooling</li>
</ul>

<h2>2. The Component Model</h2>

<div class="code-block" data-lang="Components">
<code>App
‚îú‚îÄ‚îÄ Header
‚îÇ   ‚îú‚îÄ‚îÄ Logo
‚îÇ   ‚îú‚îÄ‚îÄ Navigation
‚îÇ   ‚îî‚îÄ‚îÄ CartIcon
‚îú‚îÄ‚îÄ ProductGrid
‚îÇ   ‚îú‚îÄ‚îÄ ProductCard (reused)
‚îÇ   ‚îú‚îÄ‚îÄ ProductCard
‚îÇ   ‚îî‚îÄ‚îÄ ProductCard
‚îî‚îÄ‚îÄ Footer

Each component has:
- Own HTML structure
- Own CSS (scoped)
- Own JavaScript logic
- Receives data via "props"
- Manages internal "state"</code>
</div>

<h2>3. React vs Vue</h2>

<p><strong>React</strong> (Meta): Most popular, largest ecosystem, uses JSX. Flexible but more decisions required.</p>
<p><strong>Vue</strong>: Approachable, great docs, single-file components. More opinionated, gentler learning curve.</p>

<h2>4. Rendering Strategies</h2>

<div class="code-block" data-lang="Rendering">
<code>CSR (Client-Side): Empty HTML, JS renders everything
- Fast after load, poor SEO, slow first paint

SSR (Server-Side): Server renders HTML, JS hydrates
- Good SEO, fast first paint, more complex

SSG (Static): Pre-rendered at build time
- Fastest delivery, good for stable content

ISR (Incremental Static): Static + scheduled rebuilds
- Best of both worlds</code>
</div>

<h2>5. When to Use Frameworks</h2>

<p><strong>Use frameworks for:</strong> Complex interactive UIs, SPAs, dashboards, when team has experience</p>
<p><strong>Consider simpler approaches for:</strong> Mostly static content, simple sites, performance-critical, inexperienced team</p>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>What framework does your site use (if any)?</li>
        <li>View source: HTML content or empty div?</li>
        <li>Is it server or client rendered?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Main benefit of component-based architecture:", options: ["Faster websites", "Reusable, self-contained pieces with HTML/CSS/JS that compose into complex UIs", "Smaller files", "Better SEO"], correct: 1, explanation: "Components encapsulate structure, style, and behavior into reusable units. Build once, use everywhere." },
                { q: "CSR main disadvantage:", options: ["Slow on mobile", "Initial page empty‚Äîpoor SEO, slow first paint until JS loads", "Firefox issues", "Needs more devs"], correct: 1, explanation: "CSR sends minimal HTML, JS renders everything. Blank page until JS loads. Poor for SEO." },
                { q: "View source shows HTML content. This suggests:", options: ["CSR", "Server-side rendering (SSR/SSG)", "Site broken", "No JavaScript"], correct: 1, explanation: "Meaningful HTML in source = server-rendered. Empty div = client-rendered." },
                { q: "When NOT to use React:", options: ["Never", "For simple/static sites, or when team lacks framework experience", "Large apps", "Need components"], correct: 1, explanation: "Frameworks add complexity. For simple sites or inexperienced teams, simpler tools may be better." },
                { q: "ISR provides:", options: ["Real-time updates", "Static speed with scheduled content updates without full rebuild", "Better JS", "Smaller images"], correct: 1, explanation: "ISR combines static performance with ability to update content periodically." }
            ],
            essay: {
                question: "Evaluate headless (React/Next.js) vs traditional server-rendered ecommerce for a mid-market retailer. Cover: what headless means, pros/cons of each, decision factors, and recommendation.",
                guidance: "Cover: headless = separate frontend + APIs; headless pros (customization, modern DX) vs cons (complexity, cost, specialized devs); traditional pros (simpler, ecosystem) vs cons (less flexible); factors (team capability, customization needs, budget); mid-market usually better with traditional unless strong customization need."
            }
        }
    ],
    week3: [
        {
            day: 15,
            title: "Server-Side Rendering Patterns",
            desc: "SSR, SSG, ISR and hydration explained",
            duration: "45 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Modern web applications use various rendering strategies. Understanding these helps you evaluate platform choices, diagnose performance issues, and make informed architectural decisions.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. The Rendering Spectrum</li>
        <li>2. Server-Side Rendering (SSR)</li>
        <li>3. Static Site Generation (SSG)</li>
        <li>4. Incremental Static Regeneration (ISR)</li>
        <li>5. Hydration Explained</li>
        <li>6. Choosing the Right Strategy</li>
    </ul>
</div>

<h2>1. The Rendering Spectrum</h2>

<p>Web pages can be rendered in different places and times:</p>

<div class="code-block" data-lang="Rendering Spectrum">
<code>Build Time          Request Time          Browser
    ‚îÇ                     ‚îÇ                    ‚îÇ
    ‚ñº                     ‚ñº                    ‚ñº
   SSG                   SSR                  CSR
(Static Site       (Server-Side          (Client-Side
Generation)         Rendering)            Rendering)

Pre-built HTML ‚Üí Generated per request ‚Üí JS builds HTML

Fastest delivery    Personalized content   Interactive SPAs
Great for stable    Good SEO              Poor initial SEO
content             More server load       Needs JS to work</code>
</div>

<h2>2. Server-Side Rendering (SSR)</h2>

<p>The server generates HTML for each request. The browser receives complete HTML.</p>

<div class="code-block" data-lang="SSR Flow">
<code>1. User requests /products/luna-ring
2. Server runs application code
3. Fetches data from database/APIs
4. Renders HTML with product data
5. Sends complete HTML to browser
6. Browser displays immediately
7. JavaScript "hydrates" for interactivity

Benefits:
- Fast First Contentful Paint
- Good SEO (crawlers see content)
- Works without JavaScript (mostly)
- Personalized content per request

Drawbacks:
- Server load per request
- Time To First Byte depends on server speed
- More infrastructure complexity</code>
</div>

<div class="code-block" data-lang="Next.js SSR">
<code>// Next.js: getServerSideProps runs on every request
export async function getServerSideProps(context) {
    const product = await fetchProduct(context.params.id);
    
    return {
        props: { product }  // Passed to page component
    };
}

export default function ProductPage({ product }) {
    return (
        &lt;div&gt;
            &lt;h1&gt;{product.name}&lt;/h1&gt;
            &lt;p&gt;¬£{product.price}&lt;/p&gt;
        &lt;/div&gt;
    );
}</code>
</div>

<h2>3. Static Site Generation (SSG)</h2>

<p>Pages are pre-rendered at build time. Served as static files from CDN.</p>

<div class="code-block" data-lang="SSG Flow">
<code>Build Time:
1. Build process runs
2. Fetches all data needed
3. Generates HTML for every page
4. Outputs static files

Request Time:
1. User requests /products/luna-ring
2. CDN serves pre-built HTML instantly
3. No server processing needed

Benefits:
- Fastest possible delivery (just files)
- Infinitely scalable (CDN)
- Cheapest to host
- Most secure (no server to hack)

Drawbacks:
- Content is frozen at build time
- Full rebuild for any change
- Not suitable for personalized content</code>
</div>

<h2>4. Incremental Static Regeneration (ISR)</h2>

<p>ISR combines static speed with ability to update without full rebuild:</p>

<div class="code-block" data-lang="ISR">
<code>// Next.js ISR
export async function getStaticProps() {
    const product = await fetchProduct();
    
    return {
        props: { product },
        revalidate: 60  // Regenerate after 60 seconds
    };
}

Flow:
1. First request: Serve static page (fast)
2. In background: Check if page is stale (>60 sec)
3. If stale: Regenerate page with fresh data
4. Next request gets fresh version
5. No downtime, no full rebuild

Perfect for:
- Product pages (prices update periodically)
- Blog posts (occasional edits)
- Any content that changes but not real-time</code>
</div>

<h2>5. Hydration Explained</h2>

<p>Hydration is the process where JavaScript takes over a server-rendered page:</p>

<div class="code-block" data-lang="Hydration">
<code>Server sends:
&lt;button class="add-to-cart"&gt;Add to Cart&lt;/button&gt;
(HTML only - button visible but not interactive)

JavaScript loads and "hydrates":
1. Finds existing DOM elements
2. Attaches event listeners
3. Sets up React/Vue state
4. Now button actually works!

Problems:
- Hydration takes time (delayed interactivity)
- "Uncanny valley" - looks ready but isn't
- Hydration mismatch errors if server/client differ</code>
</div>

<div class="info-box warning">
    <div class="info-box-title">‚ö†Ô∏è Time To Interactive</div>
    <p>Users see content quickly (good LCP) but can't interact until hydration completes. If hydration is slow, users click buttons that don't work. Monitor Time To Interactive, not just First Paint.</p>
</div>

<h2>6. Choosing the Right Strategy</h2>

<div class="code-block" data-lang="Decision Guide">
<code>Homepage
‚Üí SSG or ISR (content changes infrequently)

Product Listing Page
‚Üí ISR with short revalidation (prices/stock change)

Product Detail Page
‚Üí ISR (product data relatively stable)

Cart/Checkout
‚Üí CSR or SSR (personalized, real-time)

Search Results
‚Üí SSR or CSR (dynamic, query-dependent)

Blog/Content
‚Üí SSG (rebuild on publish)

User Dashboard
‚Üí CSR (fully personalized)

Mix strategies! Most sites use multiple approaches.</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>View source on your homepage‚Äîis it SSR/SSG or CSR?</li>
        <li>How does your product page get its data?</li>
        <li>If you update a product price, how long until it shows?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Your product page takes 3 seconds to load. View source shows complete HTML. The issue is likely:", options: ["CSR problem", "SSR problem‚Äîserver is slow generating the page. Check database queries, API calls, or server capacity.", "CDN misconfiguration", "Browser issue"], correct: 1, explanation: "Complete HTML in source means server-rendered. Slow load = slow server. Investigate: database queries taking too long, slow API calls, insufficient server resources, or missing caching." },
                { q: "Marketing wants to update a banner immediately without waiting for developers. Best rendering strategy?", options: ["SSG with full rebuild", "ISR with short revalidation period, or CMS integration that triggers targeted rebuild", "Always CSR", "Manual server restart"], correct: 1, explanation: "ISR can revalidate specific pages quickly. Better yet: headless CMS with webhook triggering rebuild of just that content. Full SSG rebuild for a banner is overkill." },
                { q: "Hydration explained simply:", options: ["Drinking water", "JavaScript taking over server-rendered HTML to add interactivity‚Äîattaching event listeners and setting up state", "Database connection pooling", "CSS loading"], correct: 1, explanation: "Hydration is when JavaScript 'wakes up' static HTML. The server sends visible content, then JS makes it interactive by attaching event handlers and initializing state." },
                { q: "User complains they click 'Add to Cart' but nothing happens for 2 seconds after page appears. Problem?", options: ["Button is broken", "Hydration delay‚Äîpage looks ready but JavaScript hasn't finished attaching event listeners yet", "Database slow", "Network latency"], correct: 1, explanation: "Classic hydration issue: HTML renders quickly (button visible) but JS takes time to load and attach click handlers. During this gap, clicks don't work. Improve by reducing JS bundle or using streaming." },
                { q: "Best strategy for user account dashboard showing orders and preferences:", options: ["SSG", "CSR‚Äîcontent is personalized per user, can't pre-render at build time", "ISR", "SSR only"], correct: 1, explanation: "Dashboards are fully personalized and authenticated. CSR makes sense: fast shell loads, then fetch user data via API. SSR works too but adds server load for every page view." }
            ],
            essay: {
                question: "Your ecommerce site currently uses pure SSR for all pages. During Black Friday, server CPU hits 100% and response times spike. Propose a hybrid rendering strategy: which pages should use SSG, ISR, or SSR, and why? Include estimated infrastructure impact.",
                guidance: "Cover: homepage/landing pages to SSG (massive traffic, stable content); product listings to ISR with 5-min revalidation (stock updates); product detail pages to ISR with 1-hour revalidation (stable); cart/checkout stays SSR (personalized); search stays SSR but add Redis caching. Impact: 80%+ reduction in server requests as most traffic hits CDN. Only personalized pages need server rendering."
            }
        },
        {
            day: 16,
            title: "Authentication & Authorization",
            desc: "Sessions, JWTs, OAuth, and security patterns",
            duration: "50 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Authentication (who are you?) and authorization (what can you do?) are critical for ecommerce. Today you'll understand the patterns, tradeoffs, and security considerations.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Authentication vs Authorization</li>
        <li>2. Session-Based Authentication</li>
        <li>3. Token-Based Authentication (JWT)</li>
        <li>4. OAuth 2.0 and Social Login</li>
        <li>5. Security Best Practices</li>
    </ul>
</div>

<h2>1. Authentication vs Authorization</h2>

<div class="code-block" data-lang="Concepts">
<code>Authentication (AuthN): "Who are you?"
- Login with email/password
- Verify identity
- Result: Confirmed identity

Authorization (AuthZ): "What can you do?"
- Can this user view this order?
- Can this user access admin panel?
- Result: Permitted or denied action

Flow:
1. User logs in (authentication)
2. System confirms identity
3. User tries to access resource
4. System checks permissions (authorization)
5. Allow or deny</code>
</div>

<h2>2. Session-Based Authentication</h2>

<p>Traditional approach: server stores session state, client gets a session ID cookie.</p>

<div class="code-block" data-lang="Session Flow">
<code>Login:
1. User submits email/password
2. Server validates credentials
3. Server creates session in database/Redis:
   { id: "abc123", user_id: 456, created: "...", expires: "..." }
4. Server sends Set-Cookie: session_id=abc123; HttpOnly; Secure
5. Browser stores cookie

Subsequent Requests:
1. Browser automatically sends Cookie: session_id=abc123
2. Server looks up session in store
3. If valid, request proceeds as user 456
4. If invalid/expired, redirect to login

Logout:
1. Server deletes session from store
2. Server sends Set-Cookie with past expiry (clears cookie)</code>
</div>

<p><strong>Session cookie security attributes:</strong></p>

<div class="code-block" data-lang="Cookie Attributes">
<code>Set-Cookie: session_id=abc123;
    HttpOnly;     // Can't access via JavaScript (XSS protection)
    Secure;       // Only sent over HTTPS
    SameSite=Lax; // CSRF protection
    Path=/;       // Sent for all paths
    Max-Age=86400 // Expires in 24 hours</code>
</div>

<h2>3. Token-Based Authentication (JWT)</h2>

<p>JSON Web Tokens are self-contained‚Äîthey carry user info in the token itself.</p>

<div class="code-block" data-lang="JWT Structure">
<code>JWT: xxxxx.yyyyy.zzzzz (header.payload.signature)

Header: { "alg": "HS256", "typ": "JWT" }
Payload: { 
    "user_id": 456, 
    "email": "user@example.com",
    "role": "customer",
    "exp": 1701345600  // Expiration timestamp
}
Signature: HMAC-SHA256(header + payload, secret)

// Token is base64 encoded, NOT encrypted!
// Anyone can read the payload
// Signature prevents tampering</code>
</div>

<div class="code-block" data-lang="JWT Flow">
<code>Login:
1. User submits credentials
2. Server validates
3. Server creates JWT with user claims
4. Server sends JWT to client
5. Client stores in localStorage or cookie

Subsequent Requests:
1. Client sends: Authorization: Bearer eyJhbG...
2. Server validates signature
3. Server reads claims from token
4. No database lookup needed!

Benefits:
- Stateless (no session store)
- Scalable (any server can validate)
- Cross-domain friendly

Drawbacks:
- Can't invalidate before expiry (without blacklist)
- Larger than session IDs
- If stolen, valid until expiry</code>
</div>

<div class="info-box warning">
    <div class="info-box-title">‚ö†Ô∏è JWT Storage</div>
    <p><strong>localStorage:</strong> Vulnerable to XSS (any script can read it). Never store sensitive tokens here.</p>
    <p><strong>HttpOnly cookie:</strong> Safe from XSS but needs CSRF protection. Preferred for web apps.</p>
    <p><strong>Memory only:</strong> Safest but lost on refresh. Use with refresh tokens.</p>
</div>

<h2>4. OAuth 2.0 and Social Login</h2>

<p>OAuth lets users log in with existing accounts (Google, Facebook, Apple):</p>

<div class="code-block" data-lang="OAuth Flow">
<code>1. User clicks "Sign in with Google"

2. Redirect to Google:
   https://accounts.google.com/oauth/authorize?
   client_id=YOUR_APP_ID&
   redirect_uri=https://yourstore.com/callback&
   scope=email%20profile&
   response_type=code

3. User logs into Google, approves access

4. Google redirects back:
   https://yourstore.com/callback?code=AUTHORIZATION_CODE

5. Your server exchanges code for tokens:
   POST https://oauth2.googleapis.com/token
   { client_id, client_secret, code, grant_type: "authorization_code" }

6. Receive access_token and id_token

7. Use id_token to get user info (email, name)

8. Create or link user account in your system</code>
</div>

<h2>5. Security Best Practices</h2>

<div class="code-block" data-lang="Security Checklist">
<code>Password Storage:
‚úì Hash with bcrypt/Argon2 (never plain text!)
‚úì Salt automatically included in bcrypt
‚úó Never use MD5 or SHA1 for passwords

Session Security:
‚úì HttpOnly cookies
‚úì Secure flag (HTTPS only)
‚úì SameSite attribute
‚úì Regenerate session ID after login
‚úì Absolute timeout (e.g., 24 hours max)

Rate Limiting:
‚úì Limit login attempts (5 per minute)
‚úì Account lockout after failures
‚úì CAPTCHA after repeated failures

Multi-Factor Authentication:
‚úì TOTP (Google Authenticator)
‚úì SMS (less secure but better than nothing)
‚úì Require for admin accounts</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>Log into your site and check DevTools ‚Üí Application ‚Üí Cookies</li>
        <li>What session cookies exist? Do they have HttpOnly and Secure?</li>
        <li>Does your site offer social login? Which providers?</li>
        <li>What happens after 5 failed login attempts?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Session cookie is missing HttpOnly flag. Risk?", options: ["None", "XSS attacks can steal the session via JavaScript‚Äîattacker can hijack user accounts", "Cookie won't work", "Performance issue"], correct: 1, explanation: "Without HttpOnly, JavaScript can read document.cookie. If attacker injects script (XSS), they steal session IDs and impersonate users. HttpOnly prevents JavaScript access." },
                { q: "JWT advantage over sessions for microservices:", options: ["More secure", "Stateless validation‚Äîany service can verify the token without hitting a central session store", "Smaller size", "Never expires"], correct: 1, explanation: "JWTs are self-contained. Any service with the secret can validate them. No need to check a central session database. Great for distributed systems." },
                { q: "Developer stores JWT in localStorage. Security concern?", options: ["None‚Äîthat's standard", "Vulnerable to XSS‚Äîany JavaScript on the page can read localStorage and steal the token", "Won't work in Safari", "Too slow"], correct: 1, explanation: "localStorage is accessible to all JavaScript on the page. If attacker injects script (XSS), they steal the JWT. HttpOnly cookies are safer‚ÄîJavaScript can't access them." },
                { q: "User reports they're logged out randomly. Sessions are in Redis. What to check?", options: ["User's browser", "Redis eviction policy, session TTL, Redis memory limits, or cluster failover issues", "JavaScript errors", "DNS problems"], correct: 1, explanation: "Sessions in Redis can be lost if: Redis runs out of memory and evicts keys, TTL is too short, Redis restarts, or cluster failover drops sessions. Check Redis configuration and monitoring." },
                { q: "OAuth 'scope' parameter purpose:", options: ["Security token", "Defines what data/permissions your app is requesting from the provider (email, profile, etc.)", "Session timeout", "Encryption level"], correct: 1, explanation: "Scope tells the OAuth provider what access you're requesting. 'email profile' means you want the user's email and basic profile. Users see and approve these permissions." }
            ],
            essay: {
                question: "Your ecommerce site currently uses session-based auth with sessions in the application server's memory. You're planning to scale to multiple servers. Outline a migration plan covering: current limitations, two possible solutions (sticky sessions vs. external session store), your recommendation, and implementation steps.",
                guidance: "Cover: current problem (sessions lost when hitting different server); sticky sessions (simple but limits scaling, server failure loses sessions); external store like Redis (any server can access, survives server restarts, enables true horizontal scaling). Recommend Redis. Steps: set up Redis, configure session library to use Redis, test with multiple servers, deploy, monitor for issues."
            }
        },
        {
            day: 17,
            title: "Payment Integration",
            desc: "Stripe, PCI compliance, and payment flows",
            duration: "50 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Payment processing is critical and heavily regulated. Today you'll understand how payment integrations work, what PCI compliance means for you, and how to evaluate payment solutions.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Payment Flow Overview</li>
        <li>2. PCI Compliance Explained</li>
        <li>3. Stripe Integration Patterns</li>
        <li>4. Handling Payment Failures</li>
        <li>5. Subscriptions and Recurring Payments</li>
    </ul>
</div>

<h2>1. Payment Flow Overview</h2>

<div class="code-block" data-lang="Payment Flow">
<code>Customer ‚Üí Your Site ‚Üí Payment Gateway ‚Üí Card Network ‚Üí Bank

1. CHECKOUT: Customer enters card details
2. TOKENIZE: Card details sent directly to payment provider
   (Your server never sees full card number!)
3. TOKEN: You receive a token representing the card
4. CHARGE: Your server sends token + amount to provider
5. AUTHORIZE: Provider checks with card network/bank
6. CAPTURE: Funds reserved (auth) or moved (capture)
7. CONFIRM: You receive success/failure webhook
8. FULFILL: Ship the order

Key insight: Card details go directly to payment provider
Your PCI burden is minimized by never handling card numbers</code>
</div>

<h2>2. PCI Compliance Explained</h2>

<p>PCI DSS (Payment Card Industry Data Security Standard) has levels based on transaction volume:</p>

<div class="code-block" data-lang="PCI Levels">
<code>Level 1: 6M+ transactions/year
- Annual on-site audit by QSA
- Quarterly network scans
- Most rigorous

Level 2: 1-6M transactions/year
- Annual self-assessment (SAQ)
- Quarterly network scans

Level 3: 20K-1M e-commerce transactions/year
- Annual SAQ
- Quarterly scans

Level 4: Under 20K e-commerce transactions/year
- Annual SAQ
- Scans recommended

Using Stripe/PayPal with hosted forms = SAQ A (simplest)
You never touch card data, minimal requirements</code>
</div>

<div class="info-box success">
    <div class="info-box-title">‚úì SAQ A: Easiest Compliance Path</div>
    <p>By using Stripe Elements, PayPal buttons, or other hosted payment forms, card data never touches your servers. You qualify for SAQ A‚Äîthe simplest self-assessment questionnaire. ~22 questions vs ~300+ for SAQ D.</p>
</div>

<h2>3. Stripe Integration Patterns</h2>

<h3>Stripe Checkout (Hosted)</h3>

<div class="code-block" data-lang="Stripe Checkout">
<code>// Server: Create checkout session
const session = await stripe.checkout.sessions.create({
    payment_method_types: ['card'],
    line_items: [{
        price_data: {
            currency: 'gbp',
            product_data: { name: 'Luna Ring' },
            unit_amount: 2499,  // ¬£24.99 in pence
        },
        quantity: 1,
    }],
    mode: 'payment',
    success_url: 'https://yourstore.com/success?session_id={CHECKOUT_SESSION_ID}',
    cancel_url: 'https://yourstore.com/cart',
});

// Redirect customer to Stripe's hosted page
res.redirect(session.url);

// Stripe hosts the entire checkout form
// Maximum security, minimum PCI scope
// Less customization</code>
</div>

<h3>Stripe Elements (Embedded)</h3>

<div class="code-block" data-lang="Stripe Elements">
<code>// Client: Mount card element in your page
const elements = stripe.elements();
const cardElement = elements.create('card');
cardElement.mount('#card-element');

// On submit: Create payment method
const { paymentMethod, error } = await stripe.createPaymentMethod({
    type: 'card',
    card: cardElement,
});

// Send paymentMethod.id to your server (not card details!)
// Server creates PaymentIntent with this ID

// Your checkout design, Stripe handles card input
// Still SAQ A compliant</code>
</div>

<h2>4. Handling Payment Failures</h2>

<div class="code-block" data-lang="Error Handling">
<code>Common failure reasons:
- card_declined: Generic decline
- insufficient_funds: Not enough money
- expired_card: Card expired
- incorrect_cvc: Wrong security code
- processing_error: Try again

Idempotency Keys (CRITICAL):
// Include unique key with each payment attempt
const charge = await stripe.paymentIntents.create({
    amount: 2499,
    currency: 'gbp',
    payment_method: 'pm_xxx',
}, {
    idempotencyKey: 'order_123_attempt_1'
});

// If you retry with same key, Stripe returns original result
// Prevents double charges on timeout/retry!</code>
</div>

<div class="info-box critical">
    <div class="info-box-title">üî¥ Critical: Webhook Reliability</div>
    <p>Never rely solely on the redirect. Network issues can prevent the customer reaching your success page. Always use webhooks for order confirmation:</p>
    <ol>
        <li>Payment succeeds at Stripe</li>
        <li>Stripe sends webhook to your server</li>
        <li>You verify signature and fulfill order</li>
        <li>Redirect is just for user experience</li>
    </ol>
</div>

<h2>5. Subscriptions</h2>

<div class="code-block" data-lang="Subscriptions">
<code>// Create subscription
const subscription = await stripe.subscriptions.create({
    customer: 'cus_xxx',
    items: [{ price: 'price_monthly_box' }],
    payment_behavior: 'default_incomplete',
    expand: ['latest_invoice.payment_intent'],
});

Webhook events to handle:
- invoice.paid: Payment succeeded, fulfill
- invoice.payment_failed: Payment failed, notify customer
- customer.subscription.deleted: Cancelled
- customer.subscription.updated: Plan changed

Dunning (failed payment recovery):
- Stripe Smart Retries
- Customer emails for card update
- Grace period before cancellation</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>What payment provider does your site use?</li>
        <li>Is the card form hosted (redirect) or embedded?</li>
        <li>Check if idempotency keys are used in payment code</li>
        <li>How are failed webhooks retried?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Customer's card was charged but your site shows 'payment failed'. Most likely cause?", options: ["Card wasn't really charged", "Payment succeeded but webhook failed or your redirect handling has a bug‚Äîalways use webhooks as source of truth", "Stripe bug", "Customer lying"], correct: 1, explanation: "Payments can succeed at Stripe while your site fails to record it (webhook failed, redirect interrupted, server error). Always use webhooks as authoritative source. Check Stripe dashboard for actual payment status." },
                { q: "Using Stripe Checkout redirect means for PCI:", options: ["Full PCI audit required", "SAQ A (simplest)‚Äîcard data never touches your servers", "No compliance needed", "SAQ D required"], correct: 1, explanation: "Stripe Checkout is fully hosted. Card numbers never touch your servers, so you qualify for SAQ A‚Äîthe simplest compliance path with ~22 questions." },
                { q: "Payment times out (504). You retry without idempotency key. Risk?", options: ["None", "Double charge‚Äîoriginal payment may have succeeded, retry creates second charge", "Payment will fail", "Session expires"], correct: 1, explanation: "504 timeout means you don't know if payment succeeded. Without idempotency key, retrying can create duplicate charges. Always use idempotency keys for payment requests." },
                { q: "Webhook endpoint returns 500 error. What happens?", options: ["Payment reversed", "Stripe retries the webhook with exponential backoff over hours/days", "Customer charged twice", "Nothing"], correct: 1, explanation: "Stripe retries failed webhooks with exponential backoff for up to 3 days. Your endpoint should return 200 quickly, process asynchronously, and be idempotent (handle receiving same webhook twice)." },
                { q: "Subscription invoice fails 3 times. Then what?", options: ["Immediately cancelled", "Depends on your dunning settings‚ÄîStripe can retry, email customer, then eventually cancel after grace period", "Stripe covers the cost", "Nothing happens"], correct: 1, explanation: "Dunning management handles failed subscription payments. Configure: retry schedule, customer notification emails, grace period, and when to finally cancel. Stripe Smart Retries optimize retry timing." }
            ],
            essay: {
                question: "Your CFO asks why you use Stripe (2.9% + 30p per transaction) instead of a cheaper payment processor. Write a brief explaining: what Stripe provides beyond basic payment processing, the true cost of a cheaper processor (integration, maintenance, PCI), and the business value of Stripe's reliability and features.",
                guidance: "Cover: Stripe provides (fraud protection, dispute handling, hosted checkout, recurring billing, reporting, dashboard, international payments, webhooks); cheaper processor hidden costs (integration time, PCI scope increase, maintaining security, no fraud tools, limited support); reliability value (payment failures = lost revenue, Stripe's uptime and smart routing); features (Apple/Google Pay, Klarna, subscriptions out of box). Total cost of ownership favors Stripe for most."
            }
        },
        {
            day: 18,
            title: "Webhooks & Event Architecture",
            desc: "Designing reliable event-driven systems",
            duration: "45 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Webhooks are how external services notify you of events. Today you'll understand how to design reliable webhook handlers and event-driven architectures.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Webhooks Explained</li>
        <li>2. Reliable Webhook Handling</li>
        <li>3. Signature Verification</li>
        <li>4. Event-Driven Architecture</li>
        <li>5. Common Patterns</li>
    </ul>
</div>

<h2>1. Webhooks Explained</h2>

<p>Webhooks invert the typical request pattern. Instead of you polling "did anything happen?", services POST to your endpoint when events occur.</p>

<div class="code-block" data-lang="Webhook Flow">
<code>Without Webhooks (Polling):
Every 5 seconds:
Your Server ‚Üí "Any new orders?" ‚Üí Shopify
Your Server ‚Üí "Any new orders?" ‚Üí Shopify
Your Server ‚Üí "Any new orders?" ‚Üí Shopify
(Wasteful, slow to detect changes)

With Webhooks:
Order placed ‚Üí Shopify POSTs to your endpoint
You process immediately
(Efficient, real-time)</code>
</div>

<h2>2. Reliable Webhook Handling</h2>

<div class="code-block" data-lang="Webhook Handler">
<code>// CRITICAL: Return 200 quickly!
app.post('/webhooks/stripe', async (req, res) => {
    // 1. Verify signature first
    const sig = req.headers['stripe-signature'];
    let event;
    
    try {
        event = stripe.webhooks.constructEvent(
            req.body, sig, webhookSecret
        );
    } catch (err) {
        return res.status(400).send('Invalid signature');
    }
    
    // 2. Return 200 immediately
    res.status(200).send('Received');
    
    // 3. Process asynchronously (queue the work)
    await queue.add('processWebhook', { event });
});

// Stripe expects 200 within seconds
// If you do heavy processing before responding,
// Stripe thinks it failed and retries</code>
</div>

<h3>Idempotency in Webhook Handlers</h3>

<div class="code-block" data-lang="Idempotency">
<code>// Webhooks can be delivered multiple times!
// Your handler must be idempotent

app.post('/webhooks/orders', async (req, res) => {
    const eventId = req.body.id;
    
    // Check if already processed
    const processed = await db.query(
        'SELECT 1 FROM processed_events WHERE event_id = ?',
        [eventId]
    );
    
    if (processed) {
        return res.status(200).send('Already processed');
    }
    
    // Process the event
    await processOrder(req.body);
    
    // Mark as processed
    await db.query(
        'INSERT INTO processed_events (event_id) VALUES (?)',
        [eventId]
    );
    
    res.status(200).send('OK');
});</code>
</div>

<h2>3. Signature Verification</h2>

<div class="code-block" data-lang="Verification">
<code>// WHY: Anyone can POST to your webhook URL
// Signatures prove the request is from the claimed sender

Stripe signature header:
Stripe-Signature: t=1701345600,v1=abc123...

Verification:
1. Extract timestamp and signature from header
2. Compute expected signature:
   HMAC-SHA256(timestamp + "." + rawBody, webhookSecret)
3. Compare with provided signature
4. Check timestamp is recent (prevent replay)

// Using Stripe's SDK (recommended)
const event = stripe.webhooks.constructEvent(
    rawBody,
    signatureHeader,
    webhookSecret  // Get from Stripe dashboard
);

// NEVER skip verification in production!</code>
</div>

<h2>4. Event-Driven Architecture</h2>

<div class="code-block" data-lang="Event Architecture">
<code>Traditional (Synchronous):
Order Created
‚îú‚Üí Save to database
‚îú‚Üí Send confirmation email
‚îú‚Üí Update inventory
‚îú‚Üí Notify warehouse
‚îî‚Üí Update analytics
(All in one request - slow, fragile)

Event-Driven:
Order Created
‚îî‚Üí Publish "order.created" event
    
Subscribers react independently:
‚îú‚Üí Email Service: Send confirmation
‚îú‚Üí Inventory Service: Decrement stock
‚îú‚Üí Warehouse Service: Create pick list
‚îî‚Üí Analytics: Record conversion

Benefits:
- Loose coupling (services independent)
- Resilience (one failure doesn't block others)
- Scalability (add subscribers without changes)
- Audit trail (events are logged)</code>
</div>

<h2>5. Common Patterns</h2>

<div class="code-block" data-lang="Patterns">
<code>Fan-Out: One event triggers multiple actions
order.created ‚Üí email + inventory + shipping + analytics

Event Sourcing: Store events, derive state
Events: [ItemAdded, ItemRemoved, CheckedOut]
Cart state computed from replaying events

Saga Pattern: Multi-step processes with compensation
1. Reserve inventory
2. Charge payment
3. If payment fails ‚Üí Release inventory

Dead Letter Queue: Failed events for investigation
Webhook fails 5 times ‚Üí Move to DLQ
Investigate and replay later</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>List all webhooks your platform receives</li>
        <li>Do your handlers verify signatures?</li>
        <li>Are handlers idempotent (safe to receive twice)?</li>
        <li>How do you monitor failed webhooks?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Webhook handler does 30 seconds of processing before returning 200. Problem?", options: ["None", "Sender times out and retries, causing duplicate processing. Return 200 immediately, process asynchronously.", "Too fast", "Uses too much memory"], correct: 1, explanation: "Webhook senders expect quick responses (typically 5-30 seconds). Slow handlers cause retries. Pattern: return 200 immediately, queue the work for async processing." },
                { q: "You receive same webhook twice. Your handler creates duplicate orders. Fix?", options: ["Tell sender to fix", "Make handler idempotent‚Äîcheck event ID before processing, skip if already handled", "Ignore second one", "Faster processing"], correct: 1, explanation: "Webhooks can be delivered multiple times (sender retries, network issues). Your handler must be idempotent: store processed event IDs and skip duplicates." },
                { q: "Webhook processing fails. What's the ideal recovery pattern?", options: ["Ignore it", "Queue to retry with backoff. After max retries, move to dead letter queue for investigation.", "Alert immediately", "Reprocess all webhooks"], correct: 1, explanation: "Ideal pattern: automatic retries with exponential backoff, after max attempts move to dead letter queue. DLQ lets you investigate and manually replay failed events." },
                { q: "Verifying webhook signatures prevents:", options: ["Slow processing", "Attackers sending fake webhooks to your endpoint, triggering unintended actions", "Duplicate delivery", "Timeout errors"], correct: 1, explanation: "Your webhook URL is public. Without signature verification, attackers can POST fake events (fake payments, fake orders). Signatures prove the webhook is from the legitimate sender." },
                { q: "Event-driven architecture main benefit:", options: ["Faster", "Loose coupling‚Äîservices react to events independently, one failure doesn't cascade, easy to add new subscribers", "Less code", "Cheaper"], correct: 1, explanation: "Event-driven decouples systems. Order service publishes 'order.created', doesn't know or care who subscribes. Add new subscriber (analytics) without changing order service." }
            ],
            essay: {
                question: "Your order processing is synchronous: create order ‚Üí charge payment ‚Üí send email ‚Üí update inventory ‚Üí notify warehouse. It takes 8 seconds and sometimes fails partway through, leaving inconsistent state. Redesign using event-driven architecture. Cover: event flow, how each step subscribes, handling partial failures, and ensuring consistency.",
                guidance: "Cover: order service publishes OrderCreated event and returns; email service subscribes and sends (can fail/retry independently); inventory service subscribes and decrements (idempotent); warehouse service subscribes and creates pick list; payment can be saga pattern (reserve ‚Üí confirm or release). Partial failures handled by: idempotent handlers, retries with backoff, dead letter queue, compensation actions if needed. Eventual consistency is OK for most steps."
            }
        },
        {
            day: 19,
            title: "Message Queues & Background Jobs",
            desc: "Async processing with Redis, RabbitMQ, SQS",
            duration: "45 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Not everything should happen in the web request. Today you'll understand when and how to use message queues and background jobs for better performance and reliability.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Why Async Processing</li>
        <li>2. Message Queue Concepts</li>
        <li>3. Common Queue Technologies</li>
        <li>4. Job Processing Patterns</li>
        <li>5. Monitoring and Failure Handling</li>
    </ul>
</div>

<h2>1. Why Async Processing</h2>

<div class="code-block" data-lang="Sync vs Async">
<code>Synchronous (Blocking):
POST /orders
‚îú‚Üí Validate order (50ms)
‚îú‚Üí Charge payment (2000ms)
‚îú‚Üí Send email (500ms)
‚îú‚Üí Generate PDF invoice (1000ms)
‚îú‚Üí Update inventory (100ms)
‚îî‚Üí Return response (3650ms total!)

User waits 3.6 seconds. If email service is down,
entire order fails.

Asynchronous (Non-Blocking):
POST /orders
‚îú‚Üí Validate order (50ms)
‚îú‚Üí Charge payment (2000ms)
‚îú‚Üí Queue: send email
‚îú‚Üí Queue: generate PDF
‚îú‚Üí Queue: update inventory
‚îî‚Üí Return response (2100ms)

Background workers process queued jobs.
User gets response in 2.1 seconds.
Email failure doesn't block order.</code>
</div>

<h2>2. Message Queue Concepts</h2>

<div class="code-block" data-lang="Queue Concepts">
<code>Producer ‚Üí Queue ‚Üí Consumer

Producer: Adds messages to queue
Queue: Stores messages reliably
Consumer: Processes messages

Key Properties:
- Persistence: Messages survive restarts
- Acknowledgment: Consumer confirms processing
- Retry: Failed messages retry automatically
- Dead Letter: Failed messages after max retries

Message Lifecycle:
1. Producer publishes message
2. Message stored in queue
3. Consumer receives message
4. Consumer processes
5. Consumer acknowledges (ACK)
6. Message removed from queue

If consumer crashes before ACK:
Message returns to queue, reprocessed by another consumer</code>
</div>

<h2>3. Common Queue Technologies</h2>

<div class="code-block" data-lang="Technologies">
<code>Redis + Sidekiq/BullMQ:
- Simple, fast, good for most use cases
- Jobs stored in Redis
- Good ecosystem (Sidekiq for Ruby, BullMQ for Node)
- May lose jobs if Redis crashes without persistence

RabbitMQ:
- Purpose-built message broker
- Durable, feature-rich
- Complex routing (exchanges, bindings)
- Good for complex workflows

AWS SQS:
- Fully managed, serverless
- Scales automatically
- Pay per message
- Good for AWS-heavy architectures

AWS SQS + Lambda:
- Messages trigger Lambda functions
- No servers to manage
- Scales to zero when idle</code>
</div>

<h2>4. Job Processing Patterns</h2>

<div class="code-block" data-lang="Patterns">
<code>// Simple job
queue.add('sendEmail', {
    to: 'customer@example.com',
    template: 'order_confirmation',
    orderId: 123
});

// Delayed job
queue.add('sendFollowUp', { orderId: 123 }, {
    delay: 7 * 24 * 60 * 60 * 1000  // 7 days
});

// Scheduled/recurring job
queue.add('generateReport', {}, {
    repeat: { cron: '0 9 * * MON' }  // Every Monday 9am
});

// Priority queues
queue.add('urgent', data, { priority: 1 });  // Process first
queue.add('normal', data, { priority: 5 });

// Job batching
queue.addBulk([
    { name: 'sendEmail', data: { to: 'a@x.com' } },
    { name: 'sendEmail', data: { to: 'b@x.com' } },
    { name: 'sendEmail', data: { to: 'c@x.com' } },
]);</code>
</div>

<h2>5. Monitoring and Failure Handling</h2>

<div class="code-block" data-lang="Monitoring">
<code>Key Metrics:
- Queue depth: How many messages waiting?
- Processing time: How long per job?
- Failure rate: What percentage fail?
- Consumer count: Enough workers?

Alerting:
- Queue depth > 1000 for 5 minutes
- Failure rate > 5%
- No consumers running

Failure Handling:
// Retry with exponential backoff
attempts: 5,
backoff: {
    type: 'exponential',
    delay: 1000  // 1s, 2s, 4s, 8s, 16s
}

// Dead letter queue after max retries
// Investigate and replay manually</code>
</div>

<div class="info-box">
    <div class="info-box-title">üí° What to Queue</div>
    <ul>
        <li><strong>Emails:</strong> Don't block user for email sending</li>
        <li><strong>PDF generation:</strong> Slow, do async</li>
        <li><strong>Image processing:</strong> Thumbnails, optimization</li>
        <li><strong>Analytics:</strong> Track events in background</li>
        <li><strong>Third-party syncs:</strong> Push to CRM, marketing tools</li>
        <li><strong>Reports:</strong> Generate on schedule</li>
    </ul>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>What job queue does your platform use?</li>
        <li>What tasks are processed asynchronously?</li>
        <li>How are failed jobs handled?</li>
        <li>Is there monitoring for queue depth?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Order confirmation email takes 2 seconds to send. Currently done synchronously. Impact?", options: ["None", "User waits extra 2 seconds for checkout to complete. If email service is down, checkout fails.", "Email arrives faster", "More reliable"], correct: 1, explanation: "Synchronous email sending blocks the user and creates a failure dependency. Queue the email‚Äîuser gets response immediately, email sends in background, and email failure doesn't break checkout." },
                { q: "Queue has 50,000 messages, normally has 100. What's happening?", options: ["Normal variation", "Either producers spiking (traffic surge) or consumers failing/too slow. Check consumer health and processing time.", "More efficient", "Should delete messages"], correct: 1, explanation: "Message buildup means production rate exceeds consumption rate. Either unexpected traffic spike (add consumers) or consumers are failing/slow (check errors, processing time)." },
                { q: "Job fails, retries 5 times, still fails. Best practice?", options: ["Keep retrying forever", "Move to dead letter queue for manual investigation, alert ops team", "Delete the job", "Retry faster"], correct: 1, explanation: "After max retries, move to dead letter queue. Don't retry forever (wastes resources), don't delete (lose data). DLQ preserves the job for investigation and manual replay once fixed." },
                { q: "Consumer crashes while processing message but before ACK. What happens?", options: ["Message lost", "Message returns to queue and is reprocessed by another consumer (requires ACK-based queue)", "Automatic retry", "System crashes"], correct: 1, explanation: "With acknowledgment-based queues, unacknowledged messages return to the queue if consumer crashes. This provides at-least-once delivery. Your handler must be idempotent." },
                { q: "When NOT to use a queue:", options: ["Never", "When the result is needed immediately in the response‚Äîqueues are for fire-and-forget or delayed processing", "For emails", "For reports"], correct: 1, explanation: "Queues are for async work where you don't need the result immediately. Payment validation, reading data for display, login‚Äîthese need immediate results, don't queue." }
            ],
            essay: {
                question: "Your ecommerce platform processes orders synchronously: payment, email, inventory, warehouse notification, analytics‚Äîall in the order request. Checkout takes 8 seconds and fails completely if any step fails. Design an async architecture using queues. Cover: what stays synchronous, what gets queued, handling failures in each queue, and monitoring approach.",
                guidance: "Keep synchronous: order validation, payment (need to know if it worked). Queue: email (retry on failure), inventory update (idempotent, can retry), warehouse notification (retry), analytics (can be lossy). Each queue: retry with backoff, DLQ after max retries, monitoring for depth and failure rate. Result: checkout in 2-3 seconds, resilient to downstream failures."
            }
        },
        {
            day: 20,
            title: "Search Implementation",
            desc: "Elasticsearch, Algolia, and search UX",
            duration: "45 min",
            content: `
<h2>Today's Learning Objectives</h2>
<p>Search is critical for ecommerce‚Äîcustomers who search are 2-3x more likely to convert. Today you'll understand how search systems work and how to evaluate search solutions.</p>

<div class="toc">
    <div class="toc-title">Contents</div>
    <ul class="toc-list">
        <li>1. Why Dedicated Search</li>
        <li>2. How Search Engines Work</li>
        <li>3. Elasticsearch vs Algolia</li>
        <li>4. Search UX Best Practices</li>
        <li>5. Measuring Search Quality</li>
    </ul>
</div>

<h2>1. Why Dedicated Search</h2>

<div class="code-block" data-lang="SQL vs Search Engine">
<code>SQL LIKE Query:
SELECT * FROM products 
WHERE name LIKE '%silver ring%' 
   OR description LIKE '%silver ring%';

Problems:
‚úó Can't use indexes (full table scan)
‚úó No relevance ranking
‚úó "silver" doesn't match "925 silver"
‚úó "ring" doesn't match "rings"
‚úó "silvr" (typo) returns nothing
‚úó No faceted search

Search Engine Query:
GET /products/_search
{
    "query": {
        "multi_match": {
            "query": "silver ring",
            "fields": ["name^3", "description"],
            "fuzziness": "AUTO"
        }
    }
}

Benefits:
‚úì Sub-second on millions of products
‚úì Relevance-ranked results
‚úì Handles typos, synonyms
‚úì Stemming (ring/rings)
‚úì Faceted filtering</code>
</div>

<h2>2. How Search Engines Work</h2>

<div class="code-block" data-lang="Inverted Index">
<code>Products:
1: "Luna Silver Ring - Beautiful 925 sterling silver"
2: "Aurora Gold Necklace - Elegant pendant"
3: "Stella Silver Bracelet - Delicate chain design"

Inverted Index (simplified):
"silver"   ‚Üí [1, 3]
"ring"     ‚Üí [1]
"gold"     ‚Üí [2]
"necklace" ‚Üí [2]
"bracelet" ‚Üí [3]
"925"      ‚Üí [1]

Search "silver ring":
- "silver" ‚Üí [1, 3]
- "ring" ‚Üí [1]
- Intersection/union with scoring
- Result: 1 (matches both), then 3 (matches silver)

This is why search engines are fast:
Instead of scanning all products,
look up terms in the index.</code>
</div>

<h2>3. Elasticsearch vs Algolia</h2>

<div class="code-block" data-lang="Comparison">
<code>Elasticsearch:
‚úì Open source, self-hostable
‚úì Extremely flexible and powerful
‚úì Full control over ranking, analysis
‚úì Part of larger observability stack
‚úó Requires ops expertise
‚úó Tuning relevance is complex
‚úó You manage infrastructure

Algolia:
‚úì Fully managed SaaS
‚úì Excellent out-of-box relevance
‚úì Beautiful instant search UI components
‚úì Analytics included
‚úì Easy to implement
‚úó Expensive at scale
‚úó Less flexibility
‚úó Vendor lock-in

Recommendation:
- Algolia: Fast to implement, smaller catalogs, limited ops capacity
- Elasticsearch: Large catalogs, specific requirements, ops expertise</code>
</div>

<h2>4. Search UX Best Practices</h2>

<div class="code-block" data-lang="UX Patterns">
<code>Autocomplete/Suggestions:
- Show suggestions after 2-3 characters
- Include product images in suggestions
- Show categories: "Silver" in Rings, in Necklaces
- Recent searches for logged-in users

Instant Search:
- Results update as user types
- No submit button needed
- Debounce requests (wait 200ms after typing stops)

Faceted Navigation:
- Filter by: Category, Price range, Size, Material
- Show counts: "Silver (45)"
- Allow multiple selections
- Clear all filters option

No Results:
- Suggest corrections: "Did you mean 'silver'?"
- Show popular products
- Offer category browsing
- Never dead-end the user</code>
</div>

<h2>5. Measuring Search Quality</h2>

<div class="code-block" data-lang="Metrics">
<code>Click-Through Rate (CTR):
Searches that result in a click / Total searches
Target: 40-60%

Conversion Rate:
Searches that result in purchase / Total searches
Compare to non-search conversion

Zero Results Rate:
Searches with no results / Total searches
Target: < 5%

Search Exit Rate:
Users who leave after seeing results
High = poor relevance

Average Position of Clicked Result:
Lower is better (they found it quickly)

Top Searches with Low CTR:
These need attention - what are people searching
for that you're not serving well?</code>
</div>

<div class="exercise">
    <div class="exercise-header">üîß Practical Exercise</div>
    <ol>
        <li>Search your site for a product with a typo‚Äîdoes it handle it?</li>
        <li>Search for "ring" vs "rings"‚Äîsame results?</li>
        <li>What happens when you search for something that doesn't exist?</li>
        <li>Check your search analytics (if available)‚Äîtop queries? Zero result queries?</li>
    </ol>
</div>
`,
            questions: [
                { q: "Search for 'silvr ring' returns nothing. Fix?", options: ["Users should spell correctly", "Enable fuzzy matching‚Äîsearch engine matches 'silvr' to 'silver' within edit distance", "Add 'silvr' to product names", "Not possible"], correct: 1, explanation: "Fuzzy matching allows for typos by matching terms within an edit distance. 'silvr' is one character away from 'silver'. Elasticsearch and Algolia both support fuzziness configuration." },
                { q: "Zero results rate is 15%. What does this indicate?", options: ["Normal", "Many searches fail to find products‚Äîneed to add synonyms, fix data quality, or expand catalog", "Good performance", "Too many products"], correct: 1, explanation: "15% zero results is high (target <5%). Users are searching for things you're not matching. Investigate top zero-result queries: add synonyms, improve product data, or identify missing products." },
                { q: "Search shows exact match 'Luna Ring' below partial match 'Luna Silver Collection'. Issue?", options: ["Normal", "Relevance ranking is off‚Äîexact matches should score higher. Adjust field boosting and match scoring.", "User problem", "Too many products"], correct: 1, explanation: "Exact name matches should rank highest. Tune relevance: boost exact matches, increase name field weight (^3), consider phrase matching. Test with common searches." },
                { q: "Algolia vs self-hosted Elasticsearch. Key tradeoff?", options: ["Speed vs accuracy", "Algolia: fast setup, managed, expensive at scale. Elasticsearch: more work, more control, cheaper at scale.", "Same thing", "Algolia is always better"], correct: 1, explanation: "Algolia is SaaS‚Äîquick to implement, excellent defaults, but expensive as searches/records grow. Elasticsearch requires ops expertise but gives more control and lower costs at scale." },
                { q: "High search CTR but low conversion from search. Possible cause?", options: ["CTR is wrong", "Results are relevant enough to click but products don't meet expectations‚Äîcheck product pages, pricing, availability", "Search is too good", "Need more products"], correct: 1, explanation: "High CTR means search results are attractive to click. Low conversion after clicking suggests product pages don't convert‚Äîcould be price, out of stock, poor descriptions, or search results set wrong expectations." }
            ],
            essay: {
                question: "Your site's search uses SQL LIKE queries. It's slow (2+ seconds), doesn't handle typos, and has a 20% zero results rate. Propose a search improvement project covering: technology choice (Elasticsearch vs Algolia), implementation approach, expected improvements, and how you'd measure success.",
                guidance: "Technology: Algolia for faster implementation if budget allows, Elasticsearch for more control. Implementation: index products with name, description, attributes; configure analyzers for stemming, synonyms; implement autocomplete; add faceted filters. Expected improvements: <200ms response, <5% zero results, better relevance. Success metrics: conversion rate from search, zero results rate, search CTR, qualitative feedback."
            }
        },
        {
            day: 21,
            title: "Week 3 Review & Integration Exercise",
            desc: "Synthesize backend and integration knowledge",
            duration: "60 min",
            content: `
<h2>Week 3 Synthesis</h2>

<p>This week covered the backend systems that power ecommerce: rendering patterns, authentication, payments, events, queues, and search. Let's bring it together.</p>

<h2>The Integration Landscape</h2>

<div class="code-block" data-lang="Ecommerce Integrations">
<code>Customer Journey Integrations:

BROWSE:
‚Üí Search Engine (Elasticsearch/Algolia)
‚Üí CDN (images, static assets)
‚Üí Personalization (recommendations)

ADD TO CART:
‚Üí Session/Auth system
‚Üí Inventory check (real-time)
‚Üí Price engine (promotions)

CHECKOUT:
‚Üí Payment gateway (Stripe)
‚Üí Tax calculation (TaxJar)
‚Üí Shipping rates (carriers)
‚Üí Fraud detection

POST-PURCHASE:
‚Üí Email service (transactional)
‚Üí SMS notifications
‚Üí Warehouse/fulfillment
‚Üí Analytics/reporting
‚Üí CRM sync
‚Üí Returns system</code>
</div>

<h2>Data Flow Architecture</h2>

<div class="code-block" data-lang="Data Flow">
<code>Synchronous (User Waits):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Checkout Request                    ‚îÇ
‚îÇ  ‚îú‚Üí Validate cart                   ‚îÇ
‚îÇ  ‚îú‚Üí Calculate totals + tax          ‚îÇ
‚îÇ  ‚îú‚Üí Process payment (Stripe)        ‚îÇ
‚îÇ  ‚îî‚Üí Return order confirmation       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
Asynchronous (Background):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Event: order.created               ‚îÇ
‚îÇ  Subscribers:                       ‚îÇ
‚îÇ  ‚îú‚Üí Email service: confirmation     ‚îÇ
‚îÇ  ‚îú‚Üí Inventory: decrement stock      ‚îÇ
‚îÇ  ‚îú‚Üí Warehouse: create pick list     ‚îÇ
‚îÇ  ‚îú‚Üí Analytics: track conversion     ‚îÇ
‚îÇ  ‚îú‚Üí CRM: update customer record     ‚îÇ
‚îÇ  ‚îî‚Üí Search: update product stock    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</code>
</div>

<h2>Key Integration Patterns</h2>

<ul>
    <li><strong>Webhooks:</strong> Receive events from external services (payments, shipping updates)</li>
    <li><strong>Message Queues:</strong> Decouple internal services, handle spikes, ensure delivery</li>
    <li><strong>API Polling:</strong> When webhooks aren't available, poll with backoff</li>
    <li><strong>Batch Sync:</strong> Nightly jobs for full data reconciliation</li>
    <li><strong>Event Sourcing:</strong> Store events as source of truth, derive current state</li>
</ul>

<h2>Week 3 Capstone Exercise</h2>

<div class="exercise">
    <div class="exercise-header">üîß Integration Architecture Exercise</div>
    <p>Map your platform's integration architecture:</p>
    <ol>
        <li>List all external services your platform integrates with</li>
        <li>For each, identify: sync vs async, webhook vs polling, criticality</li>
        <li>Draw the data flow for an order from placement to fulfillment</li>
        <li>Identify single points of failure in integrations</li>
        <li>What happens if Stripe is down for 10 minutes?</li>
    </ol>
</div>

<h2>Key Vocabulary</h2>

<ul>
    <li><strong>Hydration:</strong> JavaScript taking over server-rendered HTML</li>
    <li><strong>ISR:</strong> Incremental Static Regeneration</li>
    <li><strong>JWT:</strong> JSON Web Token for stateless auth</li>
    <li><strong>PCI DSS:</strong> Payment card security standard</li>
    <li><strong>Idempotent:</strong> Safe to retry multiple times</li>
    <li><strong>Dead Letter Queue:</strong> Where failed messages go</li>
    <li><strong>Inverted Index:</strong> How search engines work</li>
</ul>
`,
            questions: [
                { q: "Order flow: payment ‚Üí email ‚Üí inventory ‚Üí warehouse. Email service is down. Impact in synchronous vs async architecture?", options: ["Same impact", "Sync: entire order fails. Async: order completes, email queued for retry when service recovers.", "Async is worse", "Neither works"], correct: 1, explanation: "Synchronous chains fail entirely on any step failure. Async/event-driven isolates failures‚Äîorder completes, email retries independently. This is why we decouple non-critical steps." },
                { q: "Stripe webhook fails to reach your server. What happens to the customer's order?", options: ["Payment fails", "Payment succeeds at Stripe but your system doesn't know. Must reconcile via Stripe API or dashboard.", "Automatic refund", "Stripe retries"], correct: 1, explanation: "Stripe processes the payment regardless of webhook delivery. If webhook fails, your system is out of sync. Stripe retries webhooks, but you should also have reconciliation jobs to catch discrepancies." },
                { q: "Choosing between Stripe Checkout (hosted) and Stripe Elements (embedded). Key factors?", options: ["Price difference", "Checkout: faster, simpler, less customization. Elements: branded experience, more work, same PCI level (SAQ A).", "Elements is more secure", "Checkout doesn't work on mobile"], correct: 1, explanation: "Both are SAQ A compliant. Checkout is Stripe-hosted (fast to implement, limited customization). Elements embeds in your page (your design, more implementation work). Choose based on customization needs vs. implementation speed." },
                { q: "Search conversion rate dropped after implementing new search. What to investigate?", options: ["Server performance", "Relevance ranking, zero results rate, whether results match user intent‚Äîcompare top queries before/after", "CSS styling", "Payment issues"], correct: 1, explanation: "Search conversion depends on relevance. Investigate: are the right products appearing? Check zero results rate, top query performance, click-through rate. Compare query analysis before and after change." },
                { q: "You need real-time inventory across 3 sales channels (website, marketplace, store). Architecture approach?", options: ["Sync each sale immediately to all channels", "Central inventory service as source of truth, each channel queries before checkout, events propagate changes", "Separate inventory per channel", "Nightly batch sync"], correct: 1, explanation: "Central inventory service is source of truth. Channels query before committing sales. Sales events propagate to update all channels. Eventual consistency is OK; double-selling is handled by the central service rejecting oversells." }
            ],
            essay: {
                question: "You're joining a company as Head of Ecommerce. During your first week, you discover: checkout is synchronous with 5-second waits, search uses SQL LIKE, there's no webhook signature verification, and failed jobs just disappear. Write a 90-day technical improvement plan prioritizing these issues. Cover: assessment approach, priority order with justification, quick wins, and how you'd communicate the plan to leadership.",
                guidance: "Assessment: audit current architecture, measure actual impact (checkout abandonment, search conversion, order discrepancies). Priority: 1) Webhook verification (security risk), 2) Failed job visibility (losing orders?), 3) Checkout async (user experience), 4) Search upgrade (conversion). Quick wins: add signature verification, set up dead letter queue and alerts, move email to async. Communication: frame as risk reduction and revenue impact, quantify where possible (checkout abandonment, search conversion), propose phased approach with milestones."
            }
        }
    ],
    week4: [
        { day: 22, title: "Ecommerce Platform Architecture", desc: "Monolith vs microservices, headless", duration: "50 min", content: `<p>Full content for Day 22.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } },
        { day: 23, title: "Performance Monitoring & APM", desc: "New Relic, DataDog, observability", duration: "45 min", content: `<p>Full content for Day 23.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } },
        { day: 24, title: "Security Best Practices", desc: "OWASP Top 10, security headers", duration: "50 min", content: `<p>Full content for Day 24.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } },
        { day: 25, title: "CI/CD & Deployment", desc: "GitHub Actions, deployment strategies", duration: "50 min", content: `<p>Full content for Day 25.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } },
        { day: 26, title: "Incident Management", desc: "Runbooks, on-call, post-mortems", duration: "45 min", content: `<p>Full content for Day 26.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } },
        { day: 27, title: "Cost Optimization", desc: "Cloud cost management, FinOps", duration: "45 min", content: `<p>Full content for Day 27.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } },
        { day: 28, title: "Week 4 Review", desc: "Operations deep dive", duration: "60 min", content: `<p>Week 4 synthesis.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } }
    ],
    bonus: [
        { day: 29, title: "Technical Leadership", desc: "Vendor management, technical hiring", duration: "45 min", content: `<p>Full content for Day 29.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } },
        { day: 30, title: "Technical Roadmapping", desc: "Strategy and presenting to executives", duration: "50 min", content: `<h2>Congratulations!</h2><p>You've completed 30 days of intensive technical training. You now have the foundation for director-level technical conversations and decisions.</p>`, questions: [{ q: "Placeholder", options: ["A", "B", "C", "D"], correct: 0, explanation: "Explanation" }], essay: { question: "Essay", guidance: "Guidance" } }
    ]
};

// Application Code
let completedDays = JSON.parse(localStorage.getItem('techFluencyCompleted') || '[]');
let currentDay = null;
let currentQuizIndex = 0;
let quizAnswers = [];
let quizScore = 0;

function init() {
    renderDashboard();
    updateProgress();
}

function renderDashboard() {
    const weeks = [
        { id: 'week1Grid', data: courseData.week1 },
        { id: 'week2Grid', data: courseData.week2 },
        { id: 'week3Grid', data: courseData.week3 },
        { id: 'week4Grid', data: courseData.week4 },
        { id: 'bonusGrid', data: courseData.bonus }
    ];
    weeks.forEach(week => {
        const grid = document.getElementById(week.id);
        if (grid && week.data) {
            grid.innerHTML = week.data.map(day => {
                const isCompleted = completedDays.includes(day.day);
                const isUnlocked = day.day === 1 || completedDays.includes(day.day - 1) || isCompleted;
                const statusClass = isCompleted ? 'completed' : (!isUnlocked ? 'locked' : (isUnlocked && !isCompleted ? 'current' : ''));
                const statusIcon = isCompleted ? '‚úì' : (!isUnlocked ? 'üîí' : '‚Üí');
                return `<div class="day-card ${statusClass}" onclick="${isUnlocked ? `openLesson(${day.day})` : ''}">
                    <div class="day-header"><span class="day-number">DAY ${day.day}</span><span>${statusIcon}</span></div>
                    <h3 class="day-title">${day.title}</h3>
                    <p class="day-desc">${day.desc}</p>
                </div>`;
            }).join('');
        }
    });
}

function findDay(dayNum) {
    const allDays = [...courseData.week1, ...courseData.week2, ...courseData.week3, ...courseData.week4, ...courseData.bonus];
    return allDays.find(d => d.day === dayNum);
}

function openLesson(dayNum) {
    const day = findDay(dayNum);
    if (!day) return;
    currentDay = dayNum;
    currentQuizIndex = 0;
    quizAnswers = [];
    quizScore = 0;
    document.getElementById('dashboardView').style.display = 'none';
    const lv = document.getElementById('lessonView');
    lv.classList.add('active');
    lv.innerHTML = `
        <div class="lesson-header">
            <button class="back-btn" onclick="closeLesson()">‚Üê Back to Dashboard</button>
            <h1 class="lesson-title">Day ${day.day}: ${day.title}</h1>
            <div class="lesson-meta">‚è± ${day.duration} | üìù ${day.questions.length} questions + essay</div>
        </div>
        <div class="lesson-content">${day.content}</div>
        <div id="quizContainer"></div>
        <div id="essayContainer"></div>
        <div class="btn-group" id="lessonActions">
            <button class="btn btn-primary" onclick="startQuiz()">Start Quiz (${day.questions.length} Questions)</button>
            <button class="btn btn-secondary" onclick="closeLesson()">Back to Dashboard</button>
        </div>`;
    window.scrollTo(0, 0);
}

function startQuiz() {
    document.getElementById('lessonActions').style.display = 'none';
    currentQuizIndex = 0;
    quizAnswers = new Array(findDay(currentDay).questions.length).fill(null);
    quizScore = 0;
    renderQuizQuestion();
}

function renderQuizQuestion() {
    const day = findDay(currentDay);
    const q = day.questions[currentQuizIndex];
    const container = document.getElementById('quizContainer');
    container.innerHTML = `
        <div class="quiz-section">
            <div class="quiz-progress">Question ${currentQuizIndex + 1} of ${day.questions.length}</div>
            <div class="quiz-question">${q.q}</div>
            <div class="quiz-options">${q.options.map((opt, i) => `
                <div class="quiz-option" onclick="selectOption(${i})">
                    <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                    <span>${opt}</span>
                </div>`).join('')}</div>
            <div class="quiz-feedback" id="quizFeedback"></div>
            <div class="quiz-nav">
                <button class="btn btn-secondary" onclick="prevQuestion()" ${currentQuizIndex === 0 ? 'disabled' : ''}>‚Üê Previous</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Next ‚Üí</button>
            </div>
        </div>`;
    container.scrollIntoView({ behavior: 'smooth' });
}

function selectOption(index) {
    const day = findDay(currentDay);
    const q = day.questions[currentQuizIndex];
    document.querySelectorAll('#quizContainer .quiz-option').forEach((opt, i) => {
        opt.classList.remove('selected', 'correct', 'incorrect');
        opt.style.pointerEvents = 'none';
        if (i === q.correct) opt.classList.add('correct');
        if (i === index && i !== q.correct) opt.classList.add('incorrect');
        if (i === index) opt.classList.add('selected');
    });
    quizAnswers[currentQuizIndex] = index;
    if (index === q.correct) quizScore++;
    const fb = document.getElementById('quizFeedback');
    fb.innerHTML = `<strong>${index === q.correct ? '‚úì Correct!' : '‚úó Incorrect'}</strong><br>${q.explanation}`;
    fb.className = `quiz-feedback show ${index === q.correct ? 'correct' : 'incorrect'}`;
    document.getElementById('nextBtn').disabled = false;
    document.getElementById('nextBtn').textContent = currentQuizIndex === day.questions.length - 1 ? 'Continue to Essay' : 'Next ‚Üí';
}

function nextQuestion() {
    const day = findDay(currentDay);
    if (currentQuizIndex < day.questions.length - 1) {
        currentQuizIndex++;
        renderQuizQuestion();
    } else {
        showEssay();
    }
}

function prevQuestion() {
    if (currentQuizIndex > 0) { currentQuizIndex--; renderQuizQuestion(); }
}

function showEssay() {
    const day = findDay(currentDay);
    document.getElementById('quizContainer').innerHTML = `
        <div class="quiz-results">
            <div class="score-display">${quizScore}/${day.questions.length}</div>
            <p>Quiz Complete - ${Math.round(quizScore/day.questions.length*100)}%</p>
        </div>`;
    document.getElementById('essayContainer').innerHTML = `
        <div class="essay-section">
            <div class="essay-header">üìù Essay Question</div>
            <div class="essay-question">${day.essay.question}</div>
            <textarea class="essay-textarea" id="essayAnswer" placeholder="Write your response here..."></textarea>
            <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.5rem;"><strong>Guidance:</strong> ${day.essay.guidance}</p>
        </div>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="completeDay(${currentDay})">Complete Day ${currentDay}</button>
            <button class="btn btn-secondary" onclick="closeLesson()">Back to Dashboard</button>
        </div>`;
    document.getElementById('essayContainer').scrollIntoView({ behavior: 'smooth' });
}

function completeDay(dayNum) {
    if (!completedDays.includes(dayNum)) {
        completedDays.push(dayNum);
        localStorage.setItem('techFluencyCompleted', JSON.stringify(completedDays));
    }
    const next = dayNum + 1;
    if (next <= 30 && findDay(next)) openLesson(next);
    else closeLesson();
}

function closeLesson() {
    document.getElementById('dashboardView').style.display = 'block';
    document.getElementById('lessonView').classList.remove('active');
    document.getElementById('lessonView').innerHTML = '';
    renderDashboard();
    updateProgress();
}

function updateProgress() {
    document.getElementById('progressFill').style.width = (completedDays.length / 30 * 100) + '%';
    document.getElementById('completedCount').textContent = completedDays.length;
}

function resetProgress() {
    if (confirm('Reset all progress?')) {
        localStorage.removeItem('techFluencyCompleted');
        completedDays = [];
        renderDashboard();
        updateProgress();
    }
}

document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
